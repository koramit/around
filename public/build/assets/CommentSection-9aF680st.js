import{_ as R,h as o,c as u,b as m,j as g,t as $,g as h,p as P,k as C,r as _,v as q,Q as x,O as z,d as c,e as b,f as T,m as V,J as E,F as I,l as L,K as D,n as B,P as M,L as F}from"./app-DaBT_1QS.js";import{_ as O}from"./FormTextarea-592s-6T8.js";import{_ as j}from"./SpinnerButton-CEyC9dqx.js";import{_ as S}from"./FormCheckbox-DtalXC8O.js";import{I as A}from"./IconEyes-DiWvcYId.js";import{I as Y}from"./IconEyesSlash-CzAiS1U1.js";const G={},J={viewBox:"0 0 512 512"};function K(s,t){return o(),u("svg",J,t[0]||(t[0]=[m("path",{fill:"currentColor",d:"M8.31 189.9l176-151.1c15.41-13.3 39.69-2.509 39.69 18.16v80.05C384.6 137.9 512 170.1 512 322.3c0 61.44-39.59 122.3-83.34 154.1c-13.66 9.938-33.09-2.531-28.06-18.62c45.34-145-21.5-183.5-176.6-185.8v87.92c0 20.7-24.31 31.45-39.69 18.16l-176-151.1C-2.753 216.6-2.784 199.4 8.31 189.9z"},null,-1)]))}const Q=R(G,[["render",K]]),W={},X={viewBox:"0 0 512 512"};function Z(s,t){return o(),u("svg",X,t[0]||(t[0]=[m("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"},null,-1)]))}const H=R(W,[["render",Z]]),ee=["innerHTML"],te={class:"mt-4 md:mt-8 flex justify-between text-xs"},ne={class:"italic text-complement"},oe={class:"ml-1 text-accent"},N={__name:"CommentBody",props:{comment:{type:Object,required:!0},showReplies:{type:Boolean},replying:{type:Boolean}},emits:["reply","show-replies"],setup(s){return(t,a)=>(o(),u("div",{class:P(["p-2 pb-1 md:p-4 md:pb-2 bg-primary-darker text-complement rounded",{"rounded-b rounded-t-none":s.comment.parent_body!==void 0&&s.comment.parent_body}])},[m("p",{innerHTML:s.comment.body},null,8,ee),m("div",te,[m("div",null,[m("button",{class:"inline-flex items-center text-accent space-x-1 md:space-x-2",onClick:a[0]||(a[0]=e=>t.$emit("reply"))},[s.replying?(o(),g(H,{key:0,class:"w-3 h-3"})):(o(),g(Q,{key:1,class:"w-3 h-3"})),a[2]||(a[2]=m("span",null,"reply",-1))]),s.comment.replies_count?(o(),u("button",{key:0,class:"inline-flex items-center text-accent ml-2 md:ml-4 space-x-1 md:space-x-2",onClick:a[1]||(a[1]=e=>t.$emit("show-replies"))},[s.showReplies?(o(),g(Y,{key:0,class:"h-3 w-3"})):(o(),g(A,{key:1,class:"h-3 w-3"})),m("span",null,$(s.comment.replies_count)+" "+$(s.comment.replies_count>1?"replies":"reply"),1)])):h("",!0)]),m("div",null,[m("span",ne,$(s.comment.at)+" by",1),m("span",oe,$(s.comment.commentator),1)])])],2))}},le={class:"mt-2 md:mt-4"},se={key:0,class:"ml-4 mt-4"},ie={class:"border-accent border-l"},ae={__name:"CommentRecursive",props:{propComment:{type:Object,required:!0}},setup(s){const a=C({...s.propComment}),e=_(null),n=_(!1),w=()=>{n.value=!n.value,n.value&&B(()=>{setTimeout(()=>{x().props.event.payload=a.id,x().props.event.name="comment-recursive-reply-active",x().props.event.fire=+new Date},300),e.value.focus()})};q(()=>x().props.event.fire,p=>{p&&x().props.event.name==="comment-recursive-reply-active"&&n.value&&a.id!==x().props.event.payload&&(n.value=!1)});const l=C({body:null,notify_op:!1}),f=()=>{window.axios.post(a.routes.reply,l).then(p=>{l.body=null,l.notify_op=!1,y.value=[...p.data],a.replies_count=y.value.length,B(()=>{n.value=!1,d.value||(d.value=!0)})}).catch(p=>console.log(p))},d=_(!1),y=_([]),k=()=>{if(d.value){d.value=!1;return}if(y.value.length){d.value=!0;return}window.axios.get(a.routes.show).then(p=>{y.value=[...p.data],d.value=!0}).catch(p=>console.log(p))};return(p,i)=>{const v=z("CommentRecursive",!0);return o(),u("li",le,[c(N,{comment:a,"show-replies":d.value,replying:n.value,onShowReplies:k,onReply:w},null,8,["comment","show-replies","replying"]),c(V,{name:"slide-fade"},{default:b(()=>[n.value?(o(),u("div",se,[c(O,{name:"body",modelValue:l.body,"onUpdate:modelValue":i[0]||(i[0]=r=>l.body=r),ref_key:"replyInput",ref:e},null,8,["modelValue"]),c(S,{toggler:!0,label:"Notify OP",modelValue:l.notify_op,"onUpdate:modelValue":i[1]||(i[1]=r=>l.notify_op=r),class:"my-2 md:mt-4"},null,8,["modelValue"]),c(j,{spin:l.processing,class:"btn btn-complement mt-4 w-full",onClick:f,disabled:!l.body},{default:b(()=>i[2]||(i[2]=[T(" REPLY ")])),_:1},8,["spin","disabled"])])):h("",!0)]),_:1}),c(V,{name:"slide-fade"},{default:b(()=>[E(m("ul",ie,[(o(!0),u(I,null,L(y.value,r=>(o(),g(v,{key:r.id,"prop-comment":r,class:"ml-4",onShowReplies:k},null,8,["prop-comment"]))),128))],512),[[D,y.value.length&&d.value]])]),_:1})])}}},re={class:"mb-4 md:mb-8"},me={__name:"CommentReplyOriented",props:{configs:{type:Object,required:!0}},setup(s){const t=s,a=_(null),e=_([]);window.axios.get(t.configs.routes.reply_index,{params:{commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id}}).then(l=>e.value=l.data).catch(l=>console.log(l));const n=C({commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id,body:null,notify_op:!1,processing:!1}),w=()=>{n.processing=!0,window.axios.post(t.configs.routes.reply_store,n).then(l=>{e.value.push(l.data),n.body=null,n.notify_op=!1}).catch(l=>console.log(l)).finally(()=>n.processing=!1)};return(l,f)=>(o(),u("div",null,[m("ul",re,[c(M,{name:"flip-list"},{default:b(()=>[(o(!0),u(I,null,L(e.value,d=>(o(),g(ae,{key:d.id,"prop-comment":d},null,8,["prop-comment"]))),128))]),_:1})]),c(O,{name:"body",modelValue:n.body,"onUpdate:modelValue":f[0]||(f[0]=d=>n.body=d),ref_key:"commentInput",ref:a},null,8,["modelValue"]),c(S,{toggler:!0,label:"Notify OP",modelValue:n.notify_op,"onUpdate:modelValue":f[1]||(f[1]=d=>n.notify_op=d),class:"my-2 md:mt-4"},null,8,["modelValue"]),c(j,{spin:n.processing,class:"btn btn-accent mt-4 w-full",onClick:w,disabled:!n.body},{default:b(()=>f[2]||(f[2]=[T(" POST ")])),_:1},8,["spin","disabled"])]))}},ce={class:"mb-4 md:mb-8"},ue=["id"],de=["onClick"],pe=["innerHTML"],fe={key:0,class:"flex justify-between items-start space-x-2 md:space-x-4 p-2 md:p-4 rounded-t-lg bg-complement/50 text-white"},ye=["innerHTML"],_e={__name:"CommentTimelineOriented",props:{configs:{type:Object,required:!0}},setup(s){const t=s,a=_([]);window.axios.get(t.configs.routes.timeline_index,{params:{commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id}}).then(i=>a.value=i.data).catch(i=>console.log(i));const e=C({commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id,body:null,notify_op:!1,parent_id:null,processing:!1}),n=_(null),w=()=>{e.processing=!0,window.axios.post(t.configs.routes.timeline_store,e).then(i=>{a.value.push(i.data),e.body=null,e.notify_op=!1,e.parent_id=null,l.body=null}).catch(i=>console.log(i)).finally(()=>e.processing=!1)},l=C({body:null}),f=i=>{if(e.parent_id===i.id){l.body=null,e.parent_id=null,e.body=null;return}l.body=i.body,e.parent_id=i.id,p("#comment_body"),setTimeout(()=>n.value.focus(),300)},d=()=>{l.body=null,e.parent_id=null},y=_(null),k=i=>{y.value=i,p(`#comment-id-${i}`),setTimeout(()=>y.value=null,2e3)},{smoothScroll:p}=F();return(i,v)=>(o(),u("div",null,[m("ul",ce,[c(M,{name:"flip-list"},{default:b(()=>[(o(!0),u(I,null,L(a.value,r=>(o(),u("li",{class:P(["mt-2 md:mt-4 scroll-mt-28 md:scroll-mt-14",{"animate-bounce":y.value===r.id}]),key:r.id,id:`comment-id-${r.id}`},[r.parent_body?(o(),u("div",{key:0,class:"cursor-pointer",onClick:U=>k(r.parent_id)},[m("p",{class:"px-4 py-1 md:px-8 md:py-2 text-xs md:text-sm bg-complement/50 text-white rounded-t italic",innerHTML:r.parent_body},null,8,pe)],8,de)):h("",!0),c(N,{onReply:U=>f(r),replying:r.id===e.parent_id,comment:r},null,8,["onReply","replying","comment"])],10,ue))),128))]),_:1})]),c(V,{name:"slide-fade"},{default:b(()=>[l.body?(o(),u("div",fe,[m("p",{innerHTML:l.body,class:"cursor-pointer",onClick:v[0]||(v[0]=r=>k(e.parent_id))},null,8,ye),m("button",{onClick:d},[c(H,{class:"w-4 h-4"})])])):h("",!0)]),_:1}),c(O,{name:"comment_body",modelValue:e.body,"onUpdate:modelValue":v[1]||(v[1]=r=>e.body=r),ref_key:"commentInput",ref:n},null,8,["modelValue"]),c(S,{toggler:!0,label:"Notify OP",modelValue:e.notify_op,"onUpdate:modelValue":v[2]||(v[2]=r=>e.notify_op=r),class:"my-2 md:mt-4"},null,8,["modelValue"]),c(j,{spin:e.processing,class:"btn btn-accent mt-4 w-full",onClick:w,disabled:!e.body},{default:b(()=>[T($(e.parent_id?"REPLY":"POST"),1)]),_:1},8,["spin","disabled"])]))}},be={name:"IconAdjustments"},ve={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"};function ge(s,t,a,e,n,w){return o(),u("svg",ve,t[0]||(t[0]=[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"},null,-1)]))}const xe=R(be,[["render",ge]]),we={class:"text-xs md:text-sm text-accent"},Te={__name:"CommentSection",props:{configs:{type:Object,required:!0}},setup(s){const t=_(x().props.user.preferences.discussion_mode);return(a,e)=>(o(),u("div",null,[m("div",we,[c(xe,{class:"mr-1 w-3 h-4 inline"}),t.value==="reply"?(o(),u("button",{key:0,onClick:e[0]||(e[0]=n=>t.value="timeline")}," Timeline oriented ")):t.value==="timeline"?(o(),u("button",{key:1,onClick:e[1]||(e[1]=n=>t.value="reply")}," Reply oriented ")):h("",!0)]),c(V,{name:"slide-fade",mode:"in-out"},{default:b(()=>[t.value==="reply"?(o(),g(me,{key:0,configs:s.configs},null,8,["configs"])):t.value==="timeline"?(o(),g(_e,{key:1,configs:s.configs},null,8,["configs"])):h("",!0)]),_:1})]))}};export{Te as _};
