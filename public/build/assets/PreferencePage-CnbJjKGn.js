import{_ as E,k as f,r as B,v as V,U as k,c as o,b as s,F as r,d as m,f as w,g as y,e as C,m as D,h as n,l as g,t as h,j as v}from"./app-DsPwriMT.js";import{_ as A}from"./FormRadio-sHFbN8bT.js";import{I as N}from"./IconLine-DWgLYGu8.js";import{_ as c}from"./FormCheckbox-Bv1_Vv8P.js";const L=["href"],P={key:1,class:"px-2 py-1 md:px-4 md:py-2 bg-accent text-white rounded-3xl italic"},F=["href"],q={key:3,class:"px-2 py-1 md:px-4 md:py-2 bg-line-app text-white rounded-3xl italic"},R={key:0},S={class:"p-2 md:p-4 border-l-2 border-accent space-y-2 md:space-y-4"},K={class:"italic"},T={key:0,class:"p-2 md:p-4 border-l-2 border-accent space-y-2 md:space-y-4"},$={class:"italic"},M={__name:"PreferencePage",props:{preferences:{type:Object,required:!0},configs:{type:Object,required:!0}},setup(i){const u=i,x=f({line_email_consent:"accepted"}),j=f({lineEmailConsentOptions:[{value:"accepted",label:"Yes please"},{value:"declined",label:"NO, I'm good"}]}),I=B(null),a=f({...u.preferences.notification}),b=f({...u.configs.event_based_notifications}),d=f({...u.configs.subscribed_channels});V([()=>b,()=>d],()=>O(),{deep:!0});const O=k(()=>{let p=Object.keys(b).map(t=>b[t].filter(l=>l.subscribed).map(l=>l.id))[0]??[],e=Object.keys(d).map(t=>d[t].filter(l=>l.subscribed).map(l=>l.id))[0]??[];window.axios.patch(u.configs.routes.update,{subscriptions:p.concat(e)}).catch(t=>console.log(t))},1500);V(()=>a,()=>U(),{deep:!0});const U=k(()=>{window.axios.patch(u.configs.routes.update,{notification:{...a}}).catch(p=>console.log(p))},1500);return(p,e)=>(n(),o(r,null,[e[11]||(e[11]=s("h2",{class:"form-label"}," Preferences ",-1)),e[12]||(e[12]=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement",id:"line-application"}," line application ",-1)),e[13]||(e[13]=s("hr",{class:"my-4 border-b border-accent"},null,-1)),i.configs.can.link_line&&i.configs.routes.link_line?(n(),o(r,{key:0},[e[6]||(e[6]=s("p",{class:"font-medium italic text-complement"}," Collect email address from LINE account ",-1)),e[7]||(e[7]=s("p",{class:"mt-2 md:mt-4"}," So we can send you less importance notifications to this email, totally optional. ",-1)),m(A,{class:"mt-4 md:mt-8 md:w-1/2 md:grid grid-cols-2 gap-x-4",name:"line_email_consent",modelValue:x.line_email_consent,"onUpdate:modelValue":e[0]||(e[0]=t=>x.line_email_consent=t),options:j.lineEmailConsentOptions},null,8,["modelValue","options"]),s("a",{class:"flex justify-center items-center gap-x-2 btn btn-accent bg-line w-full md:w-1/2 mt-4 md:mt-8",href:i.configs.routes.link_line+"?email_consent="+x.line_email_consent},[m(N,{class:"w-6 h-6 text-white"}),e[5]||(e[5]=w(" LINK "))],8,L)],64)):i.configs.routes.link_line&&!i.configs.friends.line?(n(),o("span",P,"LINKED")):y("",!0),i.configs.can.add_line&&i.configs.routes.add_line?(n(),o("a",{key:2,class:"flex justify-center items-center gap-x-2 btn btn-accent bg-line w-full md:w-1/2 mt-4 md:mt-8",href:i.configs.routes.add_line,target:"_blank",ref_key:"lineAddButton",ref:I},[m(N,{class:"w-6 h-6 text-white"}),e[8]||(e[8]=w(" ADD FRIEND "))],8,F)):i.configs.friends.line?(n(),o("span",q,"FRIENDED")):y("",!0),e[14]||(e[14]=s("hr",{class:"my-4 border-b border-dashed"},null,-1)),e[15]||(e[15]=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement",id:"notifications"}," notifications ",-1)),e[16]||(e[16]=s("hr",{class:"my-4 border-b border-accent"},null,-1)),m(c,{label:"Mute",name:"mute",class:"my-2 md:my-4",toggler:!0,modelValue:a.mute,"onUpdate:modelValue":e[1]||(e[1]=t=>a.mute=t)},null,8,["modelValue"]),m(D,{name:"slide-fade"},{default:C(()=>[a.mute?y("",!0):(n(),o("div",R,[e[9]||(e[9]=s("h3",{class:"mt-4 mb-2 md:mt-8 md:mb-4 font-medium text-complement"}," Events ",-1)),m(c,{class:"my-2 md:my-4",label:"Request approval updates",name:"notify_approval_result",modelValue:a.notify_approval_result,"onUpdate:modelValue":e[2]||(e[2]=t=>a.notify_approval_result=t),toggler:!0},null,8,["modelValue"]),s("section",S,[(n(!0),o(r,null,g(Object.keys(b),t=>(n(),o("div",{key:t},[s("label",K,h(t)+" :",1),(n(!0),o(r,null,g(b[t],l=>(n(),v(c,{key:l.id,label:l.label,toggler:!0,modelValue:l.subscribed,"onUpdate:modelValue":_=>l.subscribed=_,class:"mt-2 md:mt-4"},null,8,["label","modelValue","onUpdate:modelValue"]))),128))]))),128))]),e[10]||(e[10]=s("h3",{class:"mt-4 mb-2 md:mt-8 md:mb-4 font-medium text-complement"}," Channels ",-1)),m(c,{class:"my-2 md:my-4",label:"Auto subscribe to channel I create",name:"auto_subscribe_to_channel",modelValue:a.auto_subscribe_to_channel,"onUpdate:modelValue":e[3]||(e[3]=t=>a.auto_subscribe_to_channel=t),toggler:!0},null,8,["modelValue"]),m(c,{class:"my-2 md:my-4",label:"Auto unsubscribe from an inactive channel",name:"auto_unsubscribe_to_channel",modelValue:a.auto_unsubscribe_to_channel,"onUpdate:modelValue":e[4]||(e[4]=t=>a.auto_unsubscribe_to_channel=t),toggler:!0},null,8,["modelValue"]),Object.keys(d).length?(n(),o("section",T,[(n(!0),o(r,null,g(Object.keys(d),t=>(n(),o("div",{key:t},[s("label",$,h(t)+" :",1),(n(!0),o(r,null,g(d[t],l=>(n(),v(c,{key:l.id,label:l.label,toggler:!0,modelValue:l.subscribed,"onUpdate:modelValue":_=>l.subscribed=_,class:"mt-2 md:mt-4"},null,8,["label","modelValue","onUpdate:modelValue"]))),128))]))),128))])):y("",!0)]))]),_:1})],64))}},J=E(M,[["__scopeId","data-v-d36d5dd6"]]);export{J as default};
