import{r as f,l as _,b as l,k as T,e as i,f as d,d as t,w as B,g,c as r,s as E,F as v,m as w,t as y,q as K,h as N,D as S,n as $}from"./app-dd3bacbb.js";import{M as D}from"./ModalDialog-1b82f704.js";import{_ as F}from"./FormInput-90a1e0a7.js";import{_ as R}from"./SpinnerButton-1601a823.js";import{_ as q}from"./FormRadio-bebd229e.js";const I=t("div",{class:"font-semibold text-complement"}," Search Admission ",-1),M={class:"py-4 my-2 md:py-6 md:my-4 border-t border-b border-accent-darker"},U=t("hr",{class:"my-4 md:my-6"},null,-1),z=t("span",{class:"form-label block"},"admission data",-1),H={class:"bg-gray-100 text-gray-100 whitespace-nowrap"},L={key:1,class:"bg-white rounded shadow p-2 lg:p-4 text-sm"},G={class:"text-complement uppercase font-semibold"},J={key:0},P=t("hr",{class:"my-4 md:my-6"},null,-1),Q={class:"flex justify-end items-center"},W=["disabled"],ne={__name:"CreateForm",props:{serviceEndpoint:{type:String,required:!0},admitReasons:{type:Array,default:()=>["KT","Complication"]}},emits:["confirmed"],setup(h,{expose:x,emit:C}){const V=h,j=C,c=f(null),b=f(null),m=f(!1),n=_({an:null,hn:null,reason_for_admission:null}),e=_({an:null,hn:null,name:null,gender:null,age:null,ward_admit:null,admitted_at:null,discharged_at:null}),u=_({an:null});function k(){m.value=!0,u.an=null,Object.keys(e).map(a=>e[a]=null),window.axios.post(V.serviceEndpoint,{key:n.an}).then(a=>{if(!a.data.found){u.an=a.data.message;return}Object.keys(e).map(o=>e[o]=a.data[o])}).catch(a=>{console.log(a)}).finally(()=>{m.value=!1})}function O(){c.value.open(),Object.keys(e).map(a=>e[a]=null),$(()=>b.value.focus())}function A(){n.an=e.an,n.hn=e.hn,j("confirmed",{...n}),c.value.close()}return x({open:O}),(a,o)=>(l(),T(S,{to:"body"},[i(D,{ref_key:"modal",ref:c,"width-mode":"form-cols-1",onClosed:o[2]||(o[2]=p=>Object.keys(n).map(s=>n[s]=null))},{header:d(()=>[I]),body:d(()=>{var p;return[t("div",M,[i(F,{label:"an",name:"an",modelValue:n.an,"onUpdate:modelValue":o[0]||(o[0]=s=>n.an=s),type:"tel",error:u.an,ref_key:"anInput",ref:b,onKeydown:B(k,["enter"])},null,8,["modelValue","error","onKeydown"]),i(R,{spin:m.value,class:"btn-complement w-full mt-2",onClick:k,disabled:!((p=n.an)!=null&&p.length)},{default:d(()=>[g(" SEARCH ")]),_:1},8,["spin","disabled"]),U,z,e.hn?(l(),r("div",L,[(l(!0),r(v,null,w([...Object.keys(e)].filter(s=>e[s]),s=>(l(),r("p",{class:"mt-1 whitespace-nowrap",key:s},[t("span",G,y(s.replaceAll("_"," "))+" : ",1),g(" "+y(e[s]),1)]))),128))])):(l(),r("div",{key:0,class:E(["bg-white rounded shadow p-2 lg:p-4 text-sm",{"animate-pulse":m.value}])},[(l(!0),r(v,null,w(Object.keys(e),s=>(l(),r("div",{class:"mt-1",key:s},[t("span",H,y(s)+" placeholder ",1)]))),128))],2)),i(K,{name:"slide-fade"},{default:d(()=>[e.hn?(l(),r("div",J,[P,i(q,{label:"reason for admission",modelValue:n.reason_for_admission,"onUpdate:modelValue":o[1]||(o[1]=s=>n.reason_for_admission=s),name:"reason_for_admission",options:h.admitReasons},null,8,["modelValue","options"])])):N("",!0)]),_:1})])]}),footer:d(()=>[t("div",Q,[t("button",{class:"btn btn-accent",onClick:A,disabled:!e.an||!n.reason_for_admission}," Confirm ",8,W)])]),_:1},512)]))}};export{ne as default};
