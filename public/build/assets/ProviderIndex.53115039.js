import{r as v,s as g,o,c,a as t,F as y,v as w,b as i,w as x,T as B,k as F,t as b,i as C,q as T,x as f,d as j,y as V}from"./app.8a1dfeb0.js";import{_ as O}from"./FormInput.42f0f372.js";import{_ as S}from"./SpinnerButton.6b0f7629.js";const D={class:"grid md:grid-cols-2 gap-4 md:gap-8"},E={class:"px-2 py-1 md:px-4 md:py-2 rounded-3xl bg-line-app text-white font-semibold uppercase"},L=["onClick"],M=["onClick"],G={key:0,class:"mt-2 md:mt-4"},H=["onClick"],J={key:0,class:"p-2 md:p-4 bg-primary-darker rounded-xl"},K={class:"uppercase text-complement font-semibold border-b-2 border-primary border-dashed pb-2 md:pb-4 mb-2 md:mb-4"},Q={class:"mt-2 md:mt-4 flex items-center space-x-2 md:space-x-4"},W={class:"flex items-center"},X=t("span",{class:"form-label !mb-0"},"terms",-1),Y={class:"flex items-center"},Z=t("span",{class:"form-label !mb-0"},"detail",-1),ee={key:0,class:"flex items-center"},te=t("span",{class:"form-label !mb-0"},"callbacks",-1),ae={key:0,class:"p-2 md:p-4 bg-primary-darker rounded-xl"},se={class:"uppercase text-complement font-semibold border-b-2 border-primary border-dashed pb-2 md:pb-4 mb-2 md:mb-4"},le={class:"mt-2 md:mt-4 flex items-center space-x-2 md:space-x-4"},ne={class:"flex items-center"},oe=t("span",{class:"form-label !mb-0"},"terms",-1),de={class:"flex items-center"},ce=t("span",{class:"form-label !mb-0"},"detail",-1),ie={class:"flex items-center"},re=t("span",{class:"form-label !mb-0"},"webhook",-1),pe={__name:"ProviderIndex",props:{providers:{type:Array,required:!0},configs:{type:Object,required:!0}},setup(_){const I=_,p=v(!1),l=g({name:null,provider_id:null,channel_id:null,channel_secret:null,access_token_url:"https://api.line.me/oauth2/v2.1/token",auth_url:"https://access.line.me/oauth2/v2.1/authorize?response_type=code",profile_url:"https://api.line.me/v2/profile"}),h=v(!1),s=g({provider:null,name:null,channel_id:null,secret:null,basic_id:null,token:null,add_friend_base_url:"https://line.me/R/ti/p/"}),N=()=>{n.value="add",p.value=!1,h.value=!1,k.value=[],d.id=null,l.name=null,l.provider_id=null,l.channel_id=null,l.channel_secret=null,l.access_token_url="https://api.line.me/oauth2/v2.1/token",l.auth_url="https://access.line.me/oauth2/v2.1/authorize?response_type=code",l.profile_url="https://api.line.me/v2/profile",setTimeout(()=>p.value=!0,300)},k=v([]),d=g({}),P=u=>{Object.keys(u).map(e=>d[e]=u[e]),n.value="edit",p.value=!1,h.value=!1,window.axios.get(u.routes.show).then(e=>{l.name=e.data.name,l.provider_id=e.data.configs.provider_id,l.channel_id=e.data.configs.channel_id,l.channel_secret=e.data.configs.channel_secret,l.access_token_url=e.data.configs.access_token_url,l.auth_url=e.data.configs.auth_url,l.profile_url=e.data.configs.profile_url,d.routes.callbacks=e.data.routes.callbacks,k.value=[...e.data.bots],setTimeout(()=>p.value=!0,300)}).catch(e=>console.log(e))},A=()=>{r.value=!0,n.value==="add"?V.Inertia.post(I.configs.routes.providers_store,l,{onFinish:()=>{r.value=!1},onSuccess:()=>{n.value="edit"}}):n.value==="edit"?V.Inertia.patch(d.routes.update,l,{preserveState:!0,onFinish:()=>{r.value=!1}}):r.value=!1},U=u=>{Object.keys(u).map(e=>d[e]=u[e]),n.value="add",p.value=!1,h.value=!1,s.provider=u.name,s.name="Around Bot NS0",s.channel_id=null,s.secret=null,s.basic_id=null,s.token=null,s.add_friend_base_url="https://line.me/R/ti/p/",setTimeout(()=>h.value=!0,300)},$=g({}),q=u=>{n.value="edit",p.value=!1,h.value=!1,window.axios.get(u.routes.show).then(e=>{s.provider=d.name,s.name=e.data.name,s.channel_id=e.data.channel_id,s.secret=e.data.secret,s.basic_id=e.data.basic_id,s.token=e.data.token,s.add_friend_base_url=e.data.add_friend_base_url,Object.keys(e.data).map(a=>$[a]=e.data[a]),setTimeout(()=>h.value=!0,300)}).catch(e=>{console.log(e)})},n=v("edit"),r=v(!1),z=()=>{r.value=!0,n.value==="add"?V.Inertia.post(d.routes.bots_store,s,{onFinish:()=>{r.value=!1},onSuccess:()=>{n.value="edit"}}):n.value==="edit"?V.Inertia.patch($.routes.update,s,{preserveState:!0,onFinish:()=>{r.value=!1}}):r.value=!1};return(u,e)=>(o(),c("div",D,[t("div",null,[t("button",{class:"btn btn-accent w-full md:w-1/2 uppercase",onClick:N}," add provider "),(o(!0),c(y,null,w(_.providers,a=>(o(),c("div",{key:a.id,class:F(["mt-2 md:mt-4 flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-white shadow",{"border-r-4 border-complement":a.id===d.id}])},[t("span",E,b(a.platform),1),t("span",null,b(a.name),1),t("button",{class:"underline",onClick:m=>P(a)}," edit ",8,L),t("button",{class:"underline",onClick:m=>U(a)}," add bot ",8,M)],2))),128)),i(B,{name:"slide-fade"},{default:x(()=>[k.value.length?(o(),c("div",G,[(o(!0),c(y,null,w(k.value,a=>(o(),c("div",{key:a.id,class:F(["flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-primary-darker shadow",{"border-r-4 border-accent":a.id===$.id}])},[t("span",null,b(a.name),1),t("button",{class:"underline",onClick:m=>q(a)}," edit ",8,H)],2))),128))])):C("",!0)]),_:1})]),t("div",null,[i(B,{name:"slide-fade"},{default:x(()=>{var a;return[p.value?(o(),c("div",J,[t("h3",K,b(n.value)+" provider ",1),(o(!0),c(y,null,w(Object.keys(l),m=>(o(),T(O,{class:"mt-2 md:mt-4",label:m.replaceAll("_"," "),key:m,name:m,modelValue:l[m],"onUpdate:modelValue":R=>l[m]=R},null,8,["label","name","modelValue","onUpdate:modelValue"]))),128)),t("div",Q,[t("div",W,[X,i(f,{text:_.configs.routes.terms},null,8,["text"])]),t("div",Y,[Z,i(f,{text:`${l.name} ${_.configs.channel_detail}`},null,8,["text"])]),(a=d==null?void 0:d.routes)!=null&&a.callbacks?(o(),c("div",ee,[te,i(f,{text:d.routes.callbacks},null,8,["text"])])):C("",!0)]),i(S,{spin:r.value,class:"mt-2 md:mt-4 btn btn-accent uppercase w-full",onClick:A},{default:x(()=>[j(b(n.value==="edit"?"update":"add"),1)]),_:1},8,["spin"])])):C("",!0)]}),_:1}),i(B,{name:"slide-fade"},{default:x(()=>[h.value?(o(),c("div",ae,[t("h3",se,b(n.value)+" bot ",1),(o(!0),c(y,null,w(Object.keys(s),a=>(o(),T(O,{class:"mt-2 md:mt-4",label:a.replaceAll("_"," "),key:a,name:a,modelValue:s[a],"onUpdate:modelValue":m=>s[a]=m},null,8,["label","name","modelValue","onUpdate:modelValue"]))),128)),t("div",le,[t("div",ne,[oe,i(f,{text:_.configs.routes.terms},null,8,["text"])]),t("div",de,[ce,i(f,{text:`${s.name} ${_.configs.channel_detail}`},null,8,["text"])]),t("div",ie,[re,i(f,{text:`${_.configs.routes.base_webhooks}${s.secret}`},null,8,["text"])])]),i(S,{spin:r.value,class:"mt-2 md:mt-4 btn btn-accent uppercase w-full",onClick:z},{default:x(()=>[j(b(n.value==="edit"?"update":"add"),1)]),_:1},8,["spin"])])):C("",!0)]),_:1})])]))}};export{pe as default};
