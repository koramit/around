import{r as f,k as y,h as l,j as T,d as i,e as d,b as t,w as B,f as h,c as r,p as E,F as v,l as w,t as b,m as N,g as S,C as $,n as F}from"./app-hB5XZ3ER.js";import{M as K}from"./ModalDialog-CUOEpxmd.js";import{_ as R}from"./FormInput-Dkyy63e2.js";import{_ as D}from"./SpinnerButton-8OHSCgEJ.js";import{_ as I}from"./FormRadio-CKO3TssX.js";const M={class:"py-4 my-2 md:py-6 md:my-4 border-t border-b border-accent-darker"},U={class:"bg-gray-100 text-gray-100 whitespace-nowrap"},q={key:1,class:"bg-white rounded shadow p-2 lg:p-4 text-sm"},z={class:"text-complement uppercase font-semibold"},H={key:0},L={class:"flex justify-end items-center"},G=["disabled"],Y={__name:"CreateForm",props:{serviceEndpoint:{type:String,required:!0},admitReasons:{type:Array,default:()=>["KT","Complication"]}},emits:["confirmed"],setup(_,{expose:x,emit:C}){const V=_,j=C,u=f(null),k=f(null),m=f(!1),a=y({an:null,hn:null,reason_for_admission:null}),n=y({an:null,hn:null,name:null,gender:null,age:null,ward_admit:null,admitted_at:null,discharged_at:null}),c=y({an:null});function g(){m.value=!0,c.an=null,Object.keys(n).map(o=>n[o]=null),window.axios.post(V.serviceEndpoint,{key:a.an}).then(o=>{if(!o.data.found){c.an=o.data.message;return}Object.keys(n).map(e=>n[e]=o.data[e])}).catch(o=>{console.log(o)}).finally(()=>{m.value=!1})}function O(){u.value.open(),Object.keys(n).map(o=>n[o]=null),F(()=>k.value.focus())}function A(){a.an=n.an,a.hn=n.hn,j("confirmed",{...a}),u.value.close()}return x({open:O}),(o,e)=>(l(),T($,{to:"body"},[i(K,{ref_key:"modal",ref:u,"width-mode":"form-cols-1",onClosed:e[2]||(e[2]=p=>Object.keys(a).map(s=>a[s]=null))},{header:d(()=>e[3]||(e[3]=[t("div",{class:"font-semibold text-complement"}," Search Admission ",-1)])),body:d(()=>{var p;return[t("div",M,[i(R,{label:"an",name:"an",modelValue:a.an,"onUpdate:modelValue":e[0]||(e[0]=s=>a.an=s),type:"tel",error:c.an,ref_key:"anInput",ref:k,onKeydown:B(g,["enter"])},null,8,["modelValue","error"]),i(D,{spin:m.value,class:"btn-complement w-full mt-2",onClick:g,disabled:!((p=a.an)!=null&&p.length)},{default:d(()=>e[4]||(e[4]=[h(" SEARCH ")])),_:1},8,["spin","disabled"]),e[6]||(e[6]=t("hr",{class:"my-4 md:my-6"},null,-1)),e[7]||(e[7]=t("span",{class:"form-label block"},"admission data",-1)),n.hn?(l(),r("div",q,[(l(!0),r(v,null,w([...Object.keys(n)].filter(s=>n[s]),s=>(l(),r("p",{class:"mt-1 whitespace-nowrap",key:s},[t("span",z,b(s.replaceAll("_"," "))+" : ",1),h(" "+b(n[s]),1)]))),128))])):(l(),r("div",{key:0,class:E(["bg-white rounded shadow p-2 lg:p-4 text-sm",{"animate-pulse":m.value}])},[(l(!0),r(v,null,w(Object.keys(n),s=>(l(),r("div",{class:"mt-1",key:s},[t("span",U,b(s)+" placeholder ",1)]))),128))],2)),i(N,{name:"slide-fade"},{default:d(()=>[n.hn?(l(),r("div",H,[e[5]||(e[5]=t("hr",{class:"my-4 md:my-6"},null,-1)),i(I,{label:"reason for admission",modelValue:a.reason_for_admission,"onUpdate:modelValue":e[1]||(e[1]=s=>a.reason_for_admission=s),name:"reason_for_admission",options:_.admitReasons},null,8,["modelValue","options"])])):S("",!0)]),_:1})])]}),footer:d(()=>[t("div",L,[t("button",{class:"btn btn-accent",onClick:A,disabled:!n.an||!a.reason_for_admission}," Confirm ",8,G)])]),_:1},512)]))}};export{Y as default};
