import{_ as B}from"./FormDatetime.161b8b73.js";import D from"./DialysisSlot.7a865bb9.js";import{I as z,a as R,_ as L}from"./WardSlot.1e310f05.js";import{r as w,o,c as i,i as g,a as s,t as y,k as S,u as l,b as n,w as b,F as x,v as $,T as U,g as P,s as E,E as V,f as W,m as q,d as N,q as I,S as G,I as C,U as H,y as K}from"./app.38c78e85.js";import{t as Q}from"./throttle.3ec0c36f.js";import{_ as M}from"./FormAutocomplete.8fa969c3.js";import{_ as F}from"./FormSelect.c3f544e9.js";import{_ as J}from"./FormRadio.d8badc6b.js";import{_ as T}from"./SpinnerButton.6dc1253f.js";import{_ as O}from"./FormCheckbox.06f7604d.js";import{F as X,_ as Y}from"./FallbackSpinner.26630208.js";import{I as j}from"./IconUserMd.7fd7b247.js";import{p as Z}from"./pickBy.73a92271.js";import"./debounce.4c0b993f.js";const ee={class:"relative"},te={class:"w-full"},se=["for"],le={class:"relative"},ae=["id","name","value"],oe=s("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),ne={key:1,class:"text-red-700 mt-2 text-sm"},re=["onClick"],ie={__name:"FormAutocompleteKeyValue",props:{keyModel:{type:[String,null],default:null},valueModel:{type:[String,null],default:null},label:{type:String,default:""},endpoint:{type:String,default:""},params:{type:String,default:""},name:{type:String,required:!0},error:{type:String,default:""},lengthToStart:{type:[Number,String],default:3}},emits:["update:keyModel","update:valueModel","autosave"],setup(a,{emit:d}){const e=a,_=w([]),t=w(null),c=w(!1),f=Q(function(){if(d("update:valueModel",t.value.value),d("update:keyModel",null),t.value.value.length<e.lengthToStart){c.value&&(c.value=!1),t.value.value||d("autosave");return}window.axios.get(e.endpoint+"?search="+t.value.value+e.params).then(v=>{_.value=v.data.length?v.data:[{key:"",value:"No match found"}],c.value=!0}).catch(v=>{console.log(v)})},300),m=v=>{t.value.value=v.value,c.value=!1,d("update:valueModel",v.value),d("update:keyModel",v.key),d("autosave")};return(v,k)=>(o(),i("div",ee,[c.value?(o(),i("div",{key:0,class:"fixed inset-0 z-10",onClick:k[0]||(k[0]=h=>c.value=!1)})):g("",!0),s("div",te,[a.label?(o(),i("label",{key:0,class:"form-label",for:a.name},y(a.label)+" : ",9,se)):g("",!0),s("div",le,[s("input",{type:"text",class:S(["form-input",{"border-red-400 text-red-400":a.error}]),onInput:k[1]||(k[1]=(...h)=>l(f)&&l(f)(...h)),id:a.name,name:a.name,ref_key:"input",ref:t,value:a.valueModel},null,42,ae),oe]),a.error?(o(),i("div",ne,y(a.error),1)):g("",!0)]),n(U,{name:"fade-appear"},{default:b(()=>[c.value?(o(),i("div",{key:0,class:S(["absolute mt-1 bg-white rounded border-2 border-yellow-200 shadow-xl w-full max-h-44 py-2 overflow-y-scroll z-20 origin-top",{"scale-100 opacity-100":c.value}])},[(o(!0),i(x,null,$(_.value,h=>(o(),i("button",{class:"block w-full py-1 px-2 lg:px-3 hover:bg-primary hover:text-accent text-left",key:h.key,onClick:p=>m(h)},y(h.value),9,re))),128))],2)):g("",!0)]),_:1})]))}},de={class:"flex flex-col-reverse md:flex-row md:space-x-4"},ce={class:"space-y-2 md:w-1/2"},ue=s("label",{class:"form-label"},"patient type",-1),me=N(" Check available dates "),fe={key:0,class:"space-y-2"},_e={class:"md:w-1/2"},pe={__name:"SlotReservationForm",props:{configs:{type:Object,required:!0}},setup(a){const d=a,e=P({case_key:null,attending_staff:null,dialysis_type:null,patient_type:null,dialysis_at:null,covid_case:!1,case_label:null,date_note:null}),_=E({route_lab:d.configs.covid.route_lab,route_vaccine:d.configs.covid.route_vaccine,hn:null,cid:null});V(()=>e.case_key,p=>{if(!p){_.hn=null;return}let r=p.split("|");_.cid=r[2],_.hn=r[1],console.log(_)}),W(()=>{d.configs.case&&(e.case_key=d.configs.case.value,e.case_label=d.configs.case.label)}),V([()=>e.dialysis_type,()=>e.dialysis_at,()=>e.covid_case],()=>{c.value.length&&(c.value=[],e.date_note=null)}),V(()=>e.date_note,p=>{if(!p)return;let r=c.value.findIndex(u=>u.value===p);r!==-1&&(c.value[r].error!==void 0?e.errors.date_note=c.value[r].error:e.errors.date_note=null)});const t=()=>e.transform(p=>({...p,case_record_hashed_key:p.case_key.split("|")[0]})).post(d.configs.routes.orders_store,{preserveState:!0,onFinish:()=>{e.processing=!1}}),c=w([]),f=w(!1),m=q(()=>!e.dialysis_type||!e.dialysis_at),v=()=>{f.value=!0,window.axios.post(d.configs.routes.slot_available_dates,e.data()).then(p=>c.value=[...p.data]).catch(p=>console.log(p)).finally(()=>f.value=!1)},k=w(!1);V(()=>e.covid_case,p=>{k.value=p,p?e.dialysis_at=d.configs.covid_ward:e.dialysis_at=null});const h=q(()=>e.covid_case?d.configs.covid_dialysis:e.dialysis_at&&e.dialysis_at.search("Hemodialysis")!==-1?d.configs.in_unit_dialysis_types:d.configs.out_unit_dialysis_types);return(p,r)=>(o(),i("div",de,[s("div",ce,[n(ie,{name:"case",label:"case","key-model":l(e).case_key,"onUpdate:key-model":r[0]||(r[0]=u=>l(e).case_key=u),"value-model":l(e).case_label,"onUpdate:value-model":r[1]||(r[1]=u=>l(e).case_label=u),error:l(e).errors.case_key,endpoint:a.configs.routes.idle_cases},null,8,["key-model","value-model","error","endpoint"]),n(O,{class:"border border-dashed border-l-0 border-r-0 border-accent py-2",label:"covid-19 infected",toggler:!0,name:"covid_case",modelValue:l(e).covid_case,"onUpdate:modelValue":r[2]||(r[2]=u=>l(e).covid_case=u)},null,8,["modelValue"]),n(M,{label:"dialysis at",name:"dialysis_at",modelValue:l(e).dialysis_at,"onUpdate:modelValue":r[3]||(r[3]=u=>l(e).dialysis_at=u),endpoint:a.configs.routes.resources_api_wards,error:l(e).errors.dialysis_at,"length-to-start":1,disabled:k.value},null,8,["modelValue","endpoint","error","disabled"]),n(F,{label:"dialysis type",name:"dialysis_type",modelValue:l(e).dialysis_type,"onUpdate:modelValue":r[4]||(r[4]=u=>l(e).dialysis_type=u),options:l(h),disabled:!l(e).dialysis_at},null,8,["modelValue","options","disabled"]),s("div",null,[ue,n(J,{class:"grid grid-cols-2 gap-x-2",name:"patient_type",modelValue:l(e).patient_type,"onUpdate:modelValue":r[5]||(r[5]=u=>l(e).patient_type=u),options:a.configs.patient_types,ref:"patientTypeInput"},null,8,["modelValue","options"])]),n(M,{label:"attending",name:"attending_staff",modelValue:l(e).attending_staff,"onUpdate:modelValue":r[6]||(r[6]=u=>l(e).attending_staff=u),endpoint:a.configs.routes.resources_api_staffs,params:a.configs.routes.staffs_scope_params,error:l(e).errors.attending_staff,"length-to-start":1},null,8,["modelValue","endpoint","params","error"]),n(T,{class:"btn btn-complement w-full",spin:f.value,disabled:l(m),onClick:v},{default:b(()=>[me]),_:1},8,["spin","disabled"]),n(U,{name:"slide-fade"},{default:b(()=>[c.value.length?(o(),i("div",fe,[n(F,{label:"required date",name:"date_note",modelValue:l(e).date_note,"onUpdate:modelValue":r[7]||(r[7]=u=>l(e).date_note=u),options:c.value,error:l(e).errors.date_note},null,8,["modelValue","options","error"]),n(T,{class:"btn btn-accent w-full",spin:l(e).processing,disabled:Object.keys(l(e).data()).reduce((u,A)=>u||l(e)[A]===null,!1),onClick:t},{default:b(()=>{var u;return[N(y(((u=l(e).date_note)!=null?u:"").includes("Approval")?"REQUEST ":"")+" RESERVE ",1)]}),_:1},8,["spin","disabled"])])):g("",!0)]),_:1})]),s("div",_e,[n(U,{mode:"out-in"},{default:b(()=>[_.hn?(o(),I(G,{key:0},{fallback:b(()=>[n(X)]),default:b(()=>[n(Y,{configs:_},null,8,["configs"])]),_:1})):g("",!0)]),_:1})])]))}},ye={key:0},ve=s("p",{class:"mt-1 italic text-xs text-accent"}," \u0E4F Not in any particular order ",-1),be={key:0,class:"mt-2 lg:mt-0 mb-2 md:mb-4 grid grid-cols-1 gap-2"},ge={class:"mt-2 md:mt-4 form-label"},he={class:"w=1/4"},xe={class:"w-3/4 mt-1 mt-0 space-x-2 flex items-center"},ke={class:"block py-1 italic truncate underline"},we={class:"font-semibold text-xs flex items-center"},$e={class:"block py-1 italic truncate"},Ve={class:"font-semibold text-xs flex items-center"},Se={class:"block py-1 italic truncate"},Ie={key:1,class:"mt-1 italic text-xs text-accent"},Ue={__name:"CovidSlot",props:{slots:{type:Object,required:!0}},setup(a){return(d,e)=>a.slots.in.length||a.slots.out.length?(o(),i("div",ye,[ve,(o(),i(x,null,$(["in","out"],_=>s("div",{key:_},[n(H,{name:"flip-list",tag:"div"},{default:b(()=>[a.slots[_].length?(o(),i("div",be,[s("label",ge,y(_==="in"?"Acute Dialysis Unit":"Ward"),1),(o(!0),i(x,null,$(a.slots[_],(t,c)=>(o(),i("div",{class:S(["w-full p-2 md:p-4 rounded shadow",{"bg-green-400 p-4 h-8":!t.type,"flex justify-between items-center":t.type,"text-complement-darker bg-amber-400":t.status!==void 0&&t.status==="scheduling","text-primary bg-complement":t.status!==void 0&&(t.status==="started"||t.status==="finished"),"text-primary bg-red-400":t.status!==void 0&&t.status!=="scheduling"&&t.status!=="started"&&t.status!=="finished"}]),key:c},[t.type?(o(),i(x,{key:0},[s("div",he,[n(l(C),{href:t.order_route},{default:b(()=>[s("span",{class:S(["p-1 md:p-2 rounded-full text-xs font-semibold underline",{"bg-primary text-accent":t.status!=="submitted","bg-indigo-400 text-white":t.status==="submitted"}])},y(t.type),3)]),_:2},1032,["href"])]),s("div",xe,[n(l(C),{class:"font-semibold text-xs flex items-center",href:t.case_record_route},{default:b(()=>[t.on_ventilator?(o(),I(z,{key:0,class:"h-3 w-3 mr-1 text-green-400"})):(o(),I(R,{key:1,class:"h-3 w-3 mr-1 text-white"})),s("span",ke,y(t.patient_name),1)]),_:2},1032,["href"]),s("p",we,[n(j,{class:"h-3 w-3 mr-1 text-white"}),s("span",$e,y(t.author),1)]),s("p",Ve,[n(j,{class:"h-3 w-3 mr-1 text-white"}),s("span",Se,y(t.attending),1)])])],64)):g("",!0)],2))),128))])):g("",!0)]),_:2},1024)])),64))])):(o(),i("p",Ie," \u0E4F No cases "))}},qe={class:"md:flex items-end md:space-x-4"},Ce=["href"],Me=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," Acute dialysis unit ",-1),Fe={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll pb-2 md:pb-4 border-b-2 border-dashed border-complement"},Te={class:"font-medium text-complement italic"},je=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," Ward ",-1),Ee={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll pb-2 md:pb-4 border-b-2 border-dashed border-complement"},Ne={class:"font-medium text-complement italic"},Oe=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," COVID cases ",-1),Ae={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll"},Be={class:"font-medium text-complement italic"},et={__name:"ScheduleIndex",props:{query:{type:Object,required:!0},slots:{type:Array,required:!0},configs:{type:Object,required:!0}},setup(a){var _,t;const d=a,e=E({ref_date:(_=d.query.ref_date)!=null?_:null,full_week:((t=d.query.full_week)!=null?t:!1)==="on"});return V(()=>e,c=>{let f=Z(c);f=Object.keys(f).length?f:{remember:"forget"},f.full_week!==void 0&&(f.full_week="on"),K.Inertia.get(location.pathname,f,{preserveState:!0,preserveScroll:!0})},{deep:!0}),(c,f)=>(o(),i(x,null,[a.configs.can.create_order?(o(),I(pe,{key:0,class:"border-b-2 border-dashed pb-2 mb-2 md:pb-4 md:mb-4",configs:a.configs},null,8,["configs"])):g("",!0),s("div",qe,[n(B,{label:"reference date",name:"ref_date",modelValue:e.ref_date,"onUpdate:modelValue":f[0]||(f[0]=m=>e.ref_date=m)},null,8,["modelValue"]),s("a",{class:"block mt-4 md:mt-0 w-full btn btn-complement h-10 text-center",href:a.configs.routes.orders_export}," Export excel ",8,Ce)]),n(O,{class:"mt-6 md:mt-12 xl:mt-24",toggler:!0,modelValue:e.full_week,"onUpdate:modelValue":f[1]||(f[1]=m=>e.full_week=m),label:"Full week"},null,8,["modelValue"]),Me,s("div",Fe,[(o(!0),i(x,null,$(a.slots,m=>(o(),i("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:m.date_note},[s("label",Te,y(m.date_label),1),n(D,{slots:m.hd_unit},null,8,["slots"])]))),128))]),je,s("div",Ee,[(o(!0),i(x,null,$(a.slots,m=>(o(),i("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:m.date_note},[s("label",Ne,y(m.date_label),1),n(L,{slots:m.ward},null,8,["slots"])]))),128))]),Oe,s("div",Ae,[(o(!0),i(x,null,$(a.slots,m=>(o(),i("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:m.date_note},[s("label",Be,y(m.date_label),1),n(Ue,{slots:m.covid_cases},null,8,["slots"])]))),128))])],64))}};export{et as default};
