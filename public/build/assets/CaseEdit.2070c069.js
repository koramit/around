import{o as d,c,b as s,F as g,d as x,t as f,v as _,f as u,w as p,a,H as z,e as C,a9 as H,a6 as J,x as K,P as N,a7 as Q,E as v,r as X,i as Y,j as Z,T as O,u as o,ac as ee,a8 as oe,G as te}from"./app.a0bb8a56.js";import{u as le}from"./useSelectOther.548d5d25.js";import{u as se}from"./useConfirmForm.cc8629aa.js";import{_ as m}from"./FormInput.4007528d.js";import{_ as b}from"./FormRadio.10f5c06b.js";import{_ as A}from"./FormCheckbox.4d07f2b1.js";import{_ as k}from"./FormDatetime.e2d0f97a.js";import{_ as R}from"./ImageUploader.914564f7.js";import ae from"./FormSelectOther.97ac0dd7.js";import{I as re}from"./IconUserMd.a86d16ad.js";import{_ as j,I as ne,a as de}from"./IconDoubleDown.f7fdae50.js";import{F as ie,_ as me}from"./FallbackSpinner.505cf65f.js";import{_ as ce}from"./CommentSection.a45f11df.js";import{_ as F}from"./SpinnerButton.bb203049.js";import"./IconEyesSlash.8244c2da.js";import"./IconEyes.167ad5e6.js";import"./ModalDialog.0c0dc9ef.js";import"./FormTextarea.e65b0655.js";const ue={key:0,class:"space-y-1"},pe={class:"bg-white rounded shadow overflow-x-auto hidden md:block"},_e={class:"w-full whitespace-nowrap pb-48"},fe={class:"text-left font-semibold text-complement"},ge=["textContent","colspan"],be=["textContent"],he={class:"border-t"},Ve={class:"md:hidden space-y-2"},ye={class:"flex justify-between items-center my-2 px-2"},ve={class:"bg-primary-darker p-2 rounded-full"},xe={class:"my-2 p-2 bg-gray-100 rounded space-y-2"},$e={class:"flex items-center justify-between"},ke={class:"text-xs italic text-complement font-semibold"},Ce={class:"font-semibold text-complement text-xs flex items-center"},Ue={class:"block italic truncate"},we={class:"flex items-center justify-between"},Oe=["textContent"],Ae=["textContent"],Se={key:1,class:"italic"},Ee={__name:"OrderIndex",props:{orders:{type:Array,required:!0}},setup(h){const{setActionStore:V,resetActionStore:S}=H(),n=e=>{S(),V(e)};return(e,U)=>h.orders.length?(d(),c("div",ue,[s("div",pe,[s("table",_e,[s("tr",fe,[(d(),c(g,null,x(["On","Type","At","Status","MD"],i=>s("th",{class:"px-6 pt-6 pb-4",key:i,textContent:f(i),colspan:i==="MD"?2:1},null,8,ge)),64))]),(d(!0),c(g,null,x(h.orders,(i,y)=>(d(),c("tr",{class:"focus-within:bg-primary-darker",key:y},[(d(),c(g,null,x(["date_note","dialysis_type","ward_name","status","md"],$=>s("td",{class:"px-6 py-4 border-t",key:$,textContent:f(i[$])},null,8,be)),64)),s("td",he,[i.actions.length?(d(),_(j,{key:0,actions:i.actions,onActionClicked:n},null,8,["actions"])):u("",!0)])]))),128))])]),s("div",Ve,[(d(!0),c(g,null,x(h.orders,(i,y)=>(d(),c("div",{class:"bg-white rounded shadow my-4 p-4",key:y},[s("div",ye,[s("div",null,f(i.ward_name),1),i.actions.length>1?(d(),_(z,{key:0},{default:p(()=>[s("div",ve,[a(ne,{class:"w-4 h-4 text-accent"})])]),dropdown:p(()=>[a(de,{actions:i.actions,onActionClicked:n},null,8,["actions"])]),_:2},1024)):i.actions.length===1?(d(),_(j,{key:1,actions:i.actions,onActionClicked:n},null,8,["actions"])):u("",!0)]),s("div",xe,[s("div",$e,[s("p",ke,f(i.status),1),s("p",Ce,[a(re,{class:"h-3 w-3 mr-1"}),s("span",Ue,f(i.md),1)])]),s("div",we,[s("p",null,[C(" On : "),s("span",{class:"text-complement font-semibold",textContent:f(i.date_note)},null,8,Oe)]),s("p",null,[C(" Type : "),s("span",{class:"text-complement font-semibold",textContent:f(i.dialysis_type)},null,8,Ae)])])])]))),128))])])):(d(),c("p",Se," No order yet "))}},Ie=s("h2",{class:"form-label text-lg italic text-complement scroll-mt-16 md:scroll-mt-8",id:"case-record"}," Case record ",-1),Fe=s("hr",{class:"my-4 border-b border-accent"},null,-1),Te={class:"grid gap-2 md:grid md:gap-4 md:grid-cols-2 xl:gap-8"},De=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),Me=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Outcome : ",-1),Ne={class:"grid gap-2 md:grid-cols-2 md:gap-4 xl:gap-6"},Re=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),je={key:0,class:"grid gap-2 md:grid md:gap-4 md:grid-cols-2 xl:gap-8"},He=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),Pe=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Renal diagnosis : ",-1),Be=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),Le=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," admission diagnosis : ",-1),qe=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),Ge={class:"md:grid grid-cols-2 gap-2 lg:gap-x-8"},We=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Comorbidities : ",-1),ze={class:"mt-2 md:mt-4 xl:mt-6 grid gap-2 md:gap-4 xl:gap-6 2xl:grid-cols-2"},Je=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Indication for dialysis : ",-1),Ke={id:"indications",class:"form-scroll-mt text-red-400"},Qe={class:"mt-2 md:mt-4 xl:mt-6 grid gap-2 md:gap-4 xl:gap-6 2xl:grid-cols-2"},Xe=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),Ye=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Serology : ",-1),Ze={class:"grid gap-2 md:grid-cols-2 md:gap-4 xl:gap-6"},eo=s("label",{class:"form-label"},"HBs Ag",-1),oo=s("label",{class:"form-label"},"anti hcv",-1),to=s("label",{class:"form-label"},"anti HIV",-1),lo=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),so=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Consent : ",-1),ao={id:"opd_consent_form",class:"form-error-block form-scroll-mt"},ro={id:"ipd_consent_form",class:"form-error-block form-scroll-mt"},no=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1),io=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Medical scheme : ",-1),mo=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement",id:"orders"}," Orders ",-1),co=s("hr",{class:"my-4 border-b border-accent"},null,-1),uo=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement scroll-mt-16 md:scroll-mt-8",id:"discussion"}," discussion ",-1),po=s("hr",{class:"my-4 border-b border-accent"},null,-1),Io={__name:"CaseEdit",props:{caseRecordForm:{type:Object,required:!0},orders:{type:Array,required:!0},formConfigs:{type:Object,required:!0},gotoSection:{type:[String,null],default:null}},setup(h){const V=h,S=J(()=>oe(()=>import("./ConfirmFormComposable.4a7adc82.js"),["assets/ConfirmFormComposable.4a7adc82.js","assets/FormInput.4007528d.js","assets/app.a0bb8a56.js","assets/app.5b38193d.css","assets/SpinnerButton.bb203049.js","assets/ModalDialog.0c0dc9ef.js","assets/ModalDialog.7d4de9ea.css"])),n=K({...V.formConfigs}),e=N({...V.caseRecordForm}),U={previous_crrt:!0},{autosave:i}=Q();v(()=>e.data(),r=>{!r.previous_crrt&&!U.previous_crrt?(r.date_start_crrt=null,r.date_end_crrt=null,U.previous_crrt=!0):r.previous_crrt&&(U.previous_crrt=!1),i(r,n.routes.update)},{deep:n.can.update}),v(()=>e.indications.initiate_chronic_hd,r=>{r&&(e.indications.maintain_chronic_hd=!1,e.indications.change_from_pd=!1)}),v(()=>e.indications.maintain_chronic_hd,r=>{r&&(e.indications.initiate_chronic_hd=!1,e.indications.change_from_pd=!1)}),v(()=>e.indications.change_from_pd,r=>{r&&(e.indications.initiate_chronic_hd=!1,e.indications.maintain_chronic_hd=!1)});const y=X(null);e.insurance&&!n.insurances.includes(e.insurance)&&n.insurances.push(e.insurance),v(()=>e.insurance,r=>{r==="other"&&(w.placeholder="Other Insurance",w.configs=n.insurances,w.input=y.value,$.value.open())});const{selectOtherInput:$,selectOther:w,selectOtherClosed:P}=le(),T=()=>e.post(n.routes.case_complete),D=()=>e.put(n.routes.case_addendum),B=()=>e.transform(r=>({...r,force:!0})).post(n.routes.case_complete),L=r=>{N({reason:r}).delete(M.value.route)},{confirmForm:q,openConfirmForm:G,confirmed:W}=se(),{actionStore:M}=H();return v(()=>M.value,r=>{switch(r.name){case"complete-case":T();break;case"addendum-case":D();break;case"cancel-case":case"cancel-order":G(r.config);break}}),Y(()=>{V.gotoSection!==null&&Z(()=>{const{smoothScroll:r}=te();r(V.gotoSection)})}),(r,l)=>(d(),c(g,null,[a(O,{mode:"out-in"},{default:p(()=>[n.case_status==="active"&&n.covid.hn&&!Object.keys(r.$page.props.errors).length?(d(),_(ee,{key:0},{fallback:p(()=>[a(ie)]),default:p(()=>[a(me,{class:"mb-4",configs:n.covid},null,8,["configs"])]),_:1})):u("",!0)]),_:1}),Ie,Fe,s("div",Te,[a(m,{label:"hn",readonly:!0,name:"hn",modelValue:o(e).record.hn,"onUpdate:modelValue":l[0]||(l[0]=t=>o(e).record.hn=t)},null,8,["modelValue"]),a(m,{label:"an",readonly:!0,name:"an",modelValue:o(e).admission.an,"onUpdate:modelValue":l[1]||(l[1]=t=>o(e).admission.an=t),placeholder:"No active admission"},null,8,["modelValue"]),a(m,{label:"first md",readonly:!0,name:"first_md",modelValue:o(e).computed.first_md,"onUpdate:modelValue":l[2]||(l[2]=t=>o(e).computed.first_md=t)},null,8,["modelValue"]),a(m,{label:"first dialysis on",readonly:!0,name:"first_dialysis_at",modelValue:o(e).computed.first_dialysis_at,"onUpdate:modelValue":l[3]||(l[3]=t=>o(e).computed.first_dialysis_at=t)},null,8,["modelValue"]),a(m,{label:"latest md",readonly:!0,name:"latest_md",modelValue:o(e).computed.latest_md,"onUpdate:modelValue":l[4]||(l[4]=t=>o(e).computed.latest_md=t)},null,8,["modelValue"]),a(m,{label:"latest dialysis on",readonly:!0,name:"latest_dialysis_at",modelValue:o(e).computed.latest_dialysis_at,"onUpdate:modelValue":l[5]||(l[5]=t=>o(e).computed.latest_dialysis_at=t)},null,8,["modelValue"]),o(e).admission.an?(d(),c(g,{key:0},[a(m,{label:"admitted on",readonly:!0,name:"admitted_at",modelValue:o(e).admission.admitted_at,"onUpdate:modelValue":l[6]||(l[6]=t=>o(e).admission.admitted_at=t)},null,8,["modelValue"]),a(m,{label:"discharged on",readonly:!0,name:"discharged_at",modelValue:o(e).admission.discharged_at,"onUpdate:modelValue":l[7]||(l[7]=t=>o(e).admission.discharged_at=t)},null,8,["modelValue"]),a(m,{label:"ward admit",readonly:!0,name:"ward_admit",modelValue:o(e).admission.ward_admit,"onUpdate:modelValue":l[8]||(l[8]=t=>o(e).admission.ward_admit=t)},null,8,["modelValue"]),a(m,{label:"ward discharge",readonly:!0,name:"ward_discharge",modelValue:o(e).admission.ward_discharge,"onUpdate:modelValue":l[9]||(l[9]=t=>o(e).admission.ward_discharge=t)},null,8,["modelValue"])],64)):u("",!0)]),De,Me,s("div",Ne,[s("div",null,[a(b,{label:"renal outcome",name:"renal_outcome",modelValue:o(e).renal_outcome,"onUpdate:modelValue":l[10]||(l[10]=t=>o(e).renal_outcome=t),"allow-reset":!0,options:n.renal_outcomes,error:r.$page.props.errors.renal_outcome},null,8,["modelValue","options","error"]),a(O,{name:"slide-fade"},{default:p(()=>[o(e).renal_outcome==="Recovery"?(d(),_(m,{key:0,label:"last creatinine",class:"mt-2 md:mt-t xl:mt-6",name:"cr_before_discharge",modelValue:o(e).cr_before_discharge,"onUpdate:modelValue":l[11]||(l[11]=t=>o(e).cr_before_discharge=t),error:r.$page.props.errors.cr_before_discharge},null,8,["modelValue","error"])):u("",!0)]),_:1})]),s("div",null,[a(b,{label:"patient outcome",name:"patient_outcome",modelValue:o(e).patient_outcome,"onUpdate:modelValue":l[12]||(l[12]=t=>o(e).patient_outcome=t),"allow-reset":!0,options:n.patient_outcomes,error:r.$page.props.errors.patient_outcome},null,8,["modelValue","options","error"]),a(O,{name:"slide-fade"},{default:p(()=>[o(e).patient_outcome==="Dead"?(d(),_(m,{key:0,label:"cause of dead",class:"mt-2 md:mt-t xl:mt-6",name:"cause_of_dead",modelValue:o(e).cause_of_dead,"onUpdate:modelValue":l[13]||(l[13]=t=>o(e).cause_of_dead=t),error:r.$page.props.errors.cause_of_dead},null,8,["modelValue","error"])):u("",!0)]),_:1})])]),Re,a(A,{class:"mt-4 md:mb-4 md:mt-8 xl:mt-16",label:"Previous CRRT",modelValue:o(e).previous_crrt,"onUpdate:modelValue":l[14]||(l[14]=t=>o(e).previous_crrt=t),toggler:!0},null,8,["modelValue"]),a(O,{name:"slide-fade"},{default:p(()=>[o(e).previous_crrt?(d(),c("div",je,[a(k,{label:"date start crrt",name:"date_start_crrt",modelValue:o(e).date_start_crrt,"onUpdate:modelValue":l[15]||(l[15]=t=>o(e).date_start_crrt=t),error:r.$page.props.errors.date_start_crrt},null,8,["modelValue","error"]),a(k,{label:"date end crrt",name:"date_end_crrt",modelValue:o(e).date_end_crrt,"onUpdate:modelValue":l[16]||(l[16]=t=>o(e).date_end_crrt=t),error:r.$page.props.errors.date_end_crrt},null,8,["modelValue","error"])])):u("",!0)]),_:1}),He,Pe,a(b,{class:"sm:grid grid-cols-2 gap-x-2 lg:grid-cols-4",name:"renal_diagnosis",modelValue:o(e).renal_diagnosis,"onUpdate:modelValue":l[17]||(l[17]=t=>o(e).renal_diagnosis=t),options:[...n.renal_diagnosis],error:r.$page.props.errors.renal_diagnosis},null,8,["modelValue","options","error"]),Be,o(e).admission.an?(d(),c(g,{key:0},[Le,a(m,{name:"admission_diagnosis",modelValue:o(e).admission_diagnosis,"onUpdate:modelValue":l[18]||(l[18]=t=>o(e).admission_diagnosis=t),error:r.$page.props.errors.admission_diagnosis},null,8,["modelValue","error"]),qe],64)):u("",!0),s("div",Ge,[s("div",null,[We,s("div",ze,[(d(!0),c(g,null,x(n.comorbidities,(t,E)=>(d(),_(A,{key:E,name:t.name,label:t.label,modelValue:o(e).comorbidities[t.name],"onUpdate:modelValue":I=>o(e).comorbidities[t.name]=I},null,8,["name","label","modelValue","onUpdate:modelValue"]))),128))]),a(m,{class:"mt-2 md:mt-4 xl:mt-6 h-auto",name:"comorbidities_other",label:"Other comorbidities",modelValue:o(e).comorbidities.other,"onUpdate:modelValue":l[19]||(l[19]=t=>o(e).comorbidities.other=t),error:r.$page.props.errors["comorbidities.other"]},null,8,["modelValue","error"])]),s("div",null,[Je,s("small",Ke,f(r.$page.props.errors.indications),1),s("div",Qe,[(d(!0),c(g,null,x(n.indications,(t,E)=>(d(),_(A,{key:E,name:t.name,label:t.label,modelValue:o(e).indications[t.name],"onUpdate:modelValue":I=>o(e).indications[t.name]=I},null,8,["name","label","modelValue","onUpdate:modelValue"]))),128))]),a(m,{class:"mt-2 md:mt-4 xl:mt-6 h-auto",name:"indications.other",label:"Other indications",modelValue:o(e).indications.other,"onUpdate:modelValue":l[20]||(l[20]=t=>o(e).indications.other=t),error:r.$page.props.errors["indications.other"]},null,8,["modelValue","error"])])]),Xe,Ye,s("div",Ze,[s("div",null,[eo,a(b,{class:"grid lg:grid-cols-2 gap-x-2",name:"hbs_ag",modelValue:o(e).hbs_ag,"onUpdate:modelValue":l[21]||(l[21]=t=>o(e).hbs_ag=t),options:n.serology_results,error:r.$page.props.errors.hbs_ag},null,8,["modelValue","options","error"])]),a(k,{label:"date HBs Ag",name:"date_hbs_ag",modelValue:o(e).date_hbs_ag,"onUpdate:modelValue":l[22]||(l[22]=t=>o(e).date_hbs_ag=t)},null,8,["modelValue"]),s("div",null,[oo,a(b,{class:"grid lg:grid-cols-2 gap-x-2",name:"anti_hcv",modelValue:o(e).anti_hcv,"onUpdate:modelValue":l[23]||(l[23]=t=>o(e).anti_hcv=t),options:n.serology_results,error:r.$page.props.errors.anti_hcv},null,8,["modelValue","options","error"])]),a(k,{label:"date anti hcv",name:"date_anti_hcv",modelValue:o(e).date_anti_hcv,"onUpdate:modelValue":l[24]||(l[24]=t=>o(e).date_anti_hcv=t)},null,8,["modelValue"]),s("div",null,[to,a(b,{class:"grid lg:grid-cols-2 gap-x-2",name:"anti_hiv",modelValue:o(e).anti_hiv,"onUpdate:modelValue":l[25]||(l[25]=t=>o(e).anti_hiv=t),options:n.serology_results,error:r.$page.props.errors.anti_hiv},null,8,["modelValue","options","error"])]),a(k,{label:"date anti HIV",name:"date_anti_hiv",modelValue:o(e).date_anti_hiv,"onUpdate:modelValue":l[26]||(l[26]=t=>o(e).date_anti_hiv=t)},null,8,["modelValue"])]),lo,so,a(R,{label:"\u0E4F opd consent form",pathname:n.opd_consent_form_pathname,modelValue:o(e).opd_consent_form,"onUpdate:modelValue":l[27]||(l[27]=t=>o(e).opd_consent_form=t),"service-endpoints":n.image_upload_endpoints},null,8,["pathname","modelValue","service-endpoints"]),s("small",ao,f(r.$page.props.errors.opd_consent_form),1),o(e).admission.an?(d(),c(g,{key:1},[a(R,{class:"mt-4 md:mt-6",label:"\u0E4F ipd consent form",pathname:n.ipd_consent_form_pathname,"service-endpoints":n.image_upload_endpoints,modelValue:o(e).ipd_consent_form,"onUpdate:modelValue":l[28]||(l[28]=t=>o(e).ipd_consent_form=t)},null,8,["pathname","service-endpoints","modelValue"]),s("small",ro,f(r.$page.props.errors.ipd_consent_form),1),a(A,{class:"mt-4 md:mt-6",label:"Use same form",name:"same_consent_form",modelValue:o(e).same_consent_form,"onUpdate:modelValue":l[29]||(l[29]=t=>o(e).same_consent_form=t),toggler:!0},null,8,["modelValue"])],64)):u("",!0),no,io,a(b,{name:"insurance",class:"md:grid grid-cols-2 gap-2",modelValue:o(e).insurance,"onUpdate:modelValue":l[30]||(l[30]=t=>o(e).insurance=t),options:n.insurances,"allow-other":!0,ref_key:"insurance",ref:y,error:r.$page.props.errors.insurance},null,8,["modelValue","options","error"]),n.can.complete?(d(),_(F,{key:2,onClick:T,spin:o(e).processing,class:"mt-4 md:mt-8 w-full btn-accent"},{default:p(()=>[C(" COMPLETE CASE ")]),_:1},8,["spin"])):u("",!0),n.can.force_complete?(d(),_(F,{key:3,onClick:B,spin:o(e).processing,class:"mt-4 md:mt-8 w-full btn-complement"},{default:p(()=>[C(" COMPLETE CASE WITHOUT CONSENT FORM ")]),_:1},8,["spin"])):u("",!0),n.can.addendum?(d(),_(F,{key:4,onClick:D,spin:o(e).processing,class:"mt-4 md:mt-8 w-full btn-complement"},{default:p(()=>[C(" ADDENDUM CASE ")]),_:1},8,["spin"])):u("",!0),mo,co,a(Ee,{orders:h.orders},null,8,["orders"]),uo,po,a(ce,{configs:n.comment},null,8,["configs"]),a(ae,{placeholder:o(w).placeholder,ref_key:"selectOtherInput",ref:$,onClosed:o(P)},null,8,["placeholder","onClosed"]),a(o(S),{ref_key:"confirmForm",ref:q,onConfirmed:l[31]||(l[31]=t=>o(W)(t,L))},null,512)],64))}};export{Io as default};
