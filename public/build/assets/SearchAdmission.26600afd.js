import{r,s as V,m as E,o as d,q as B,b as f,w as u,a as n,t as s,h as L,u as j,c as o,F as v,v as y,k as F,d as w,N as I,n as K}from"./app.70e2076b.js";import{M}from"./ModalDialog.23dc38e1.js";import{_ as O}from"./FormInput.5cee54ab.js";import{_ as T}from"./SpinnerButton.0bac3934.js";const q={class:"font-semibold text-complement"},D={class:"py-4 my-2 md:py-6 md:my-4 border-t border-b border-accent-darker"},R=w(" SEARCH "),$=n("hr",{class:"my-4 md:my-6"},null,-1),z={class:"form-label block"},H={class:"bg-gray-100 text-gray-100 whitespace-nowrap"},P={key:1,class:"bg-white rounded shadow p-2 lg:p-4 text-sm"},U={class:"text-complement uppercase font-semibold"},G={class:"flex justify-end items-center"},J=["disabled"],Z={__name:"SearchAdmission",props:{heading:{type:String,default:"Search Admission"},confirmLabel:{type:String,default:"CONFIRM"},mode:{type:String,default:"an"},serviceEndpoint:{type:String,required:!0}},emits:["confirmed"],setup(c,{expose:k,emit:x}){const _=c,h=r(null),p=r(null),l=r(""),i=r(""),m=r(!1),a=V({an:"",hn:"",name:"",gender:"",age:"",ward_admit:"",admitted_at:"",discharged_at:""}),S=E(()=>a.admitted_at?a.discharged_at?"latest admission":"active admission":a.hn?"patient data":null),b=()=>{m.value=!0,i.value="",a.hn="",window.axios.post(_.serviceEndpoint,{key:l.value}).then(e=>{if(!e.data.hn){i.value="Patient not found";return}(!e.data.found||e.data.discharged_at)&&(i.value="No active admission"),_.mode==="hn"&&(a.an=e.data.an,a.location=e.data.location),a.hn=e.data.hn,a.name=e.data.name,a.gender=e.data.gender,a.age=e.data.age,a.ward_admit=e.data.ward_admit,a.admitted_at=e.data.admitted_at,a.discharged_at=e.data.discharged_at}).catch(e=>{console.log(e)}).finally(()=>m.value=!1)},C=()=>{l.value="",i.value="",a.hn=""},A=()=>{h.value.open(),K(()=>p.value.focus())},N=()=>{h.value.close(),x("confirmed",{hn:a.hn,an:a.an})};return k({open:A}),(e,g)=>(d(),B(I,{to:"body"},[f(M,{ref_key:"modal",ref:h,"width-mode":"form-cols-1",onClosed:C},{header:u(()=>[n("div",q,s(c.heading),1)]),body:u(()=>[n("div",D,[f(O,{name:"an",label:c.mode,modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=t=>l.value=t),pattern:"\\d*",type:"number",ref_key:"anInput",ref:p,error:i.value,onKeydown:L(b,["enter"])},null,8,["label","modelValue","error","onKeydown"]),f(T,{spin:m.value,class:"btn-complement w-full mt-2",onClick:b,disabled:!l.value.length},{default:u(()=>[R]),_:1},8,["spin","disabled"]),$,n("span",z,s(j(S)),1),a.hn?(d(),o("div",P,[(d(!0),o(v,null,y([...Object.keys(a)].filter(t=>a[t]),t=>(d(),o("p",{class:"mt-1 whitespace-nowrap",key:t},[n("span",U,s(t.replaceAll("_"," "))+" : ",1),w(" "+s(a[t]),1)]))),128))])):(d(),o("div",{key:0,class:F(["bg-white rounded shadow p-2 lg:p-4 text-sm",{"animate-pulse":m.value}])},[(d(!0),o(v,null,y(Object.keys(a),t=>(d(),o("div",{class:"mt-1",key:t},[n("span",H,s(t)+" placeholder ",1)]))),128))],2))])]),footer:u(()=>[n("div",G,[n("button",{class:"btn btn-accent",onClick:N,disabled:!a.hn},s(c.confirmLabel),9,J)])]),_:1},512)]))}};export{Z as default};
