import{_ as A}from"./FormDatetime.8e7989ed.js";import D from"./DialysisSlot.f1945de3.js";import{I as R,a as K,_ as L}from"./WardSlot.4580a4fe.js";import{r as w,o as s,c as r,i as g,a,t as y,k as V,u as o,b as d,w as x,F as k,v as $,T as I,g as P,s as j,E as S,f as W,m as q,d as B,q as C,S as G,I as U,U as H,y as Q}from"./app.e266bcee.js";import{t as E,p as J}from"./throttle.fdd9f315.js";import{_ as M}from"./FormSelect.e32d134d.js";import{_ as X}from"./FormRadio.75a5594a.js";import{_ as T}from"./SpinnerButton.a335336d.js";import{_ as O}from"./FormCheckbox.7aed38ca.js";import{F as Y,_ as Z}from"./FallbackSpinner.2a8cc9d4.js";import{I as F}from"./IconUserMd.31d02a1a.js";import"./debounce.7c98259e.js";const ee={class:"relative"},te={class:"w-full"},le=["for"],ae={class:"relative"},se=["id","name","value"],oe=a("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),ne={key:1,class:"text-red-700 mt-2 text-sm"},re=["onClick"],ie={__name:"FormAutocompleteKeyValue",props:{keyModel:{type:[String,null],default:null},valueModel:{type:[String,null],default:null},label:{type:String,default:""},endpoint:{type:String,default:""},params:{type:String,default:""},name:{type:String,required:!0},error:{type:String,default:""},lengthToStart:{type:[Number,String],default:3}},emits:["update:keyModel","update:valueModel","autosave"],setup(t,{emit:i}){const e=t,p=w([]),l=w(null),n=w(!1),m=E(function(){if(i("update:valueModel",l.value.value),i("update:keyModel",null),l.value.value.length<e.lengthToStart){n.value&&(n.value=!1),l.value.value||i("autosave");return}window.axios.get(e.endpoint+"?search="+l.value.value+e.params).then(_=>{p.value=_.data.length?_.data:[{key:"",value:"No match found"}],n.value=!0}).catch(_=>{console.log(_)})},300),f=_=>{l.value.value=_.value,n.value=!1,i("update:valueModel",_.value),i("update:keyModel",_.key),i("autosave")};return(_,h)=>(s(),r("div",ee,[n.value?(s(),r("div",{key:0,class:"fixed inset-0 z-10",onClick:h[0]||(h[0]=b=>n.value=!1)})):g("",!0),a("div",te,[t.label?(s(),r("label",{key:0,class:"form-label",for:t.name},y(t.label)+" : ",9,le)):g("",!0),a("div",ae,[a("input",{type:"text",class:V(["form-input",{"border-red-400 text-red-400":t.error}]),onInput:h[1]||(h[1]=(...b)=>o(m)&&o(m)(...b)),id:t.name,name:t.name,ref_key:"input",ref:l,value:t.valueModel},null,42,se),oe]),t.error?(s(),r("div",ne,y(t.error),1)):g("",!0)]),d(I,{name:"fade-appear"},{default:x(()=>[n.value?(s(),r("div",{key:0,class:V(["absolute mt-1 bg-white rounded border-2 border-yellow-200 shadow-xl w-full max-h-44 py-2 overflow-y-scroll z-20 origin-top",{"scale-100 opacity-100":n.value}])},[(s(!0),r(k,null,$(p.value,b=>(s(),r("button",{class:"block w-full py-1 px-2 lg:px-3 hover:bg-primary hover:text-accent text-left",key:b.key,onClick:v=>f(b)},y(b.value),9,re))),128))],2)):g("",!0)]),_:1})]))}},de={class:"relative"},ue={class:"w-full"},ce=["for"],me={class:"relative"},fe=["id","name","value","disabled"],pe=a("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),_e={key:1,class:"text-red-700 mt-2 text-sm"},ve=["onClick"],N={__name:"FormAutocomplete",props:{modelValue:{type:String,default:""},modelKey:{type:String,default:""},label:{type:String,default:""},endpoint:{type:String,default:""},params:{type:String,default:""},name:{type:String,required:!0},error:{type:String,default:""},lengthToStart:{type:Number,default:3},disabled:{type:Boolean}},emits:["update:modelValue","autosave"],setup(t,{emit:i}){const e=t,p=w([]),l=w(null),n=w(!1),m=E(function(){if(i("update:modelValue",l.value.value),l.value.value.length<e.lengthToStart){n.value&&(n.value=!1),l.value.value||i("autosave");return}window.axios.get(e.endpoint+"?search="+l.value.value+e.params).then(_=>{p.value=_.data.length?_.data:["No match found"],n.value=!0}).catch(_=>{console.log(_)})},300),f=_=>{l.value.value=_,n.value=!1,i("update:modelValue",_),i("autosave")};return(_,h)=>(s(),r("div",de,[n.value?(s(),r("div",{key:0,class:"fixed inset-0 z-10",onClick:h[0]||(h[0]=b=>n.value=!1)})):g("",!0),a("div",ue,[t.label?(s(),r("label",{key:0,class:"form-label",for:t.name},y(t.label)+" : ",9,ce)):g("",!0),a("div",me,[a("input",{type:"text",class:V(["form-input",{"border-red-400 text-red-400":t.error}]),onInput:h[1]||(h[1]=(...b)=>o(m)&&o(m)(...b)),id:t.name,name:t.name,ref_key:"input",ref:l,value:t.modelValue,disabled:t.disabled},null,42,fe),pe]),t.error?(s(),r("div",_e,y(t.error),1)):g("",!0)]),d(I,{name:"fade-appear"},{default:x(()=>[n.value?(s(),r("div",{key:0,class:V(["absolute mt-1 bg-white rounded border-2 border-yellow-200 shadow-xl w-full max-h-44 py-2 overflow-y-scroll z-20 origin-top",{"scale-100 opacity-100":n.value}])},[(s(!0),r(k,null,$(p.value,(b,v)=>(s(),r("button",{class:"block w-full py-1 px-2 lg:px-3 hover:bg-primary hover:text-accent text-left",key:v,onClick:u=>f(b)},y(b),9,ve))),128))],2)):g("",!0)]),_:1})]))}},ye={class:"flex flex-col-reverse md:flex-row md:space-x-4"},be={class:"space-y-2 md:w-1/2"},ge=a("label",{class:"form-label"},"patient type",-1),he=B(" Check available dates "),xe={key:0,class:"space-y-2"},ke={class:"md:w-1/2"},we={__name:"SlotReservationForm",props:{configs:{type:Object,required:!0}},setup(t){const i=t,e=P({case_key:null,attending_staff:null,dialysis_type:null,patient_type:null,dialysis_at:null,covid_case:!1,case_label:null,date_note:null}),p=j({route_lab:i.configs.covid.route_lab,route_vaccine:i.configs.covid.route_vaccine,hn:null,cid:null});S(()=>e.case_key,v=>{if(!v){p.hn=null;return}let u=v.split("|");p.cid=u[2],p.hn=u[1],console.log(p)}),W(()=>{i.configs.case&&(e.case_key=i.configs.case.value,e.case_label=i.configs.case.label)}),S([()=>e.dialysis_type,()=>e.dialysis_at,()=>e.covid_case],()=>{n.value.length&&(n.value=[],e.date_note=null)}),S(()=>e.date_note,v=>{if(!v)return;let u=n.value.findIndex(c=>c.value===v);u!==-1&&(n.value[u].error!==void 0?e.errors.date_note=n.value[u].error:e.errors.date_note=null)});const l=()=>e.transform(v=>({...v,case_record_hashed_key:v.case_key.split("|")[0]})).post(i.configs.routes.orders_store,{preserveState:!0,onFinish:()=>{e.processing=!1}}),n=w([]),m=w(!1),f=q(()=>!e.dialysis_type||!e.dialysis_at),_=()=>{m.value=!0,window.axios.post(i.configs.routes.slot_available_dates,e.data()).then(v=>n.value=[...v.data]).catch(v=>console.log(v)).finally(()=>m.value=!1)},h=w(!1);S(()=>e.covid_case,v=>{h.value=v,v?e.dialysis_at=i.configs.covid_ward:e.dialysis_at=null});const b=q(()=>e.covid_case?i.configs.covid_dialysis:e.dialysis_at&&e.dialysis_at.search("Hemodialysis")!==-1?i.configs.in_unit_dialysis_types:i.configs.out_unit_dialysis_types);return(v,u)=>(s(),r("div",ye,[a("div",be,[d(ie,{name:"case",label:"case","key-model":o(e).case_key,"onUpdate:key-model":u[0]||(u[0]=c=>o(e).case_key=c),"value-model":o(e).case_label,"onUpdate:value-model":u[1]||(u[1]=c=>o(e).case_label=c),error:o(e).errors.case_key,endpoint:t.configs.routes.idle_cases},null,8,["key-model","value-model","error","endpoint"]),d(O,{class:"border border-dashed border-l-0 border-r-0 border-accent py-2",label:"covid-19 infected",toggler:!0,name:"covid_case",modelValue:o(e).covid_case,"onUpdate:modelValue":u[2]||(u[2]=c=>o(e).covid_case=c)},null,8,["modelValue"]),d(N,{label:"dialysis at",name:"dialysis_at",modelValue:o(e).dialysis_at,"onUpdate:modelValue":u[3]||(u[3]=c=>o(e).dialysis_at=c),endpoint:t.configs.routes.resources_api_wards,error:o(e).errors.dialysis_at,"length-to-start":1,disabled:h.value},null,8,["modelValue","endpoint","error","disabled"]),d(M,{label:"dialysis type",name:"dialysis_type",modelValue:o(e).dialysis_type,"onUpdate:modelValue":u[4]||(u[4]=c=>o(e).dialysis_type=c),options:o(b),disabled:!o(e).dialysis_at},null,8,["modelValue","options","disabled"]),a("div",null,[ge,d(X,{class:"grid grid-cols-2 gap-x-2",name:"patient_type",modelValue:o(e).patient_type,"onUpdate:modelValue":u[5]||(u[5]=c=>o(e).patient_type=c),options:t.configs.patient_types,ref:"patientTypeInput"},null,8,["modelValue","options"])]),d(N,{label:"attending",name:"attending_staff",modelValue:o(e).attending_staff,"onUpdate:modelValue":u[6]||(u[6]=c=>o(e).attending_staff=c),endpoint:t.configs.routes.resources_api_staffs,params:t.configs.routes.staffs_scope_params,error:o(e).errors.attending_staff,"length-to-start":1},null,8,["modelValue","endpoint","params","error"]),d(T,{class:"btn btn-complement w-full",spin:m.value,disabled:o(f),onClick:_},{default:x(()=>[he]),_:1},8,["spin","disabled"]),d(I,{name:"slide-fade"},{default:x(()=>[n.value.length?(s(),r("div",xe,[d(M,{label:"required date",name:"date_note",modelValue:o(e).date_note,"onUpdate:modelValue":u[7]||(u[7]=c=>o(e).date_note=c),options:n.value,error:o(e).errors.date_note},null,8,["modelValue","options","error"]),d(T,{class:"btn btn-accent w-full",spin:o(e).processing,disabled:Object.keys(o(e).data()).reduce((c,z)=>c||o(e)[z]===null,!1),onClick:l},{default:x(()=>{var c;return[B(y(((c=o(e).date_note)!=null?c:"").includes("Approval")?"REQUEST ":"")+" RESERVE ",1)]}),_:1},8,["spin","disabled"])])):g("",!0)]),_:1})]),a("div",ke,[d(I,{mode:"out-in"},{default:x(()=>[p.hn?(s(),C(G,{key:0},{fallback:x(()=>[d(Y)]),default:x(()=>[d(Z,{configs:p},null,8,["configs"])]),_:1})):g("",!0)]),_:1})])]))}},$e={key:0},Ve=a("p",{class:"mt-1 italic text-xs text-accent"}," \u0E4F Not in any particular order ",-1),Se={key:0,class:"mt-2 lg:mt-0 mb-2 md:mb-4 grid grid-cols-1 gap-2"},Ie={class:"mt-2 md:mt-4 form-label"},Ce={class:"w=1/4"},qe={class:"w-3/4 mt-1 mt-0 space-x-2 flex items-center"},Ue={class:"block py-1 italic truncate underline"},Me={class:"font-semibold text-xs flex items-center"},Te={class:"block py-1 italic truncate"},Fe={class:"font-semibold text-xs flex items-center"},Ne={class:"block py-1 italic truncate"},je={key:1,class:"mt-1 italic text-xs text-accent"},Be={__name:"CovidSlot",props:{slots:{type:Object,required:!0}},setup(t){return(i,e)=>t.slots.in.length||t.slots.out.length?(s(),r("div",$e,[Ve,(s(),r(k,null,$(["in","out"],p=>a("div",{key:p},[d(H,{name:"flip-list",tag:"div"},{default:x(()=>[t.slots[p].length?(s(),r("div",Se,[a("label",Ie,y(p==="in"?"Acute Dialysis Unit":"Ward"),1),(s(!0),r(k,null,$(t.slots[p],(l,n)=>(s(),r("div",{class:V(["w-full p-2 md:p-4 rounded shadow",{"bg-green-400 p-4 h-8":!l.type,"flex justify-between items-center":l.type,"text-complement-darker bg-amber-400":l.status!==void 0&&l.status==="scheduling","text-primary bg-complement":l.status!==void 0&&(l.status==="started"||l.status==="finished"),"text-primary bg-red-400":l.status!==void 0&&l.status!=="scheduling"&&l.status!=="started"&&l.status!=="finished"}]),key:n},[l.type?(s(),r(k,{key:0},[a("div",Ce,[d(o(U),{href:l.order_route},{default:x(()=>[a("span",{class:V(["p-1 md:p-2 rounded-full text-xs font-semibold underline",{"bg-primary text-accent":l.status!=="submitted","bg-indigo-400 text-white":l.status==="submitted"}])},y(l.type),3)]),_:2},1032,["href"])]),a("div",qe,[d(o(U),{class:"font-semibold text-xs flex items-center",href:l.case_record_route},{default:x(()=>[l.on_ventilator?(s(),C(R,{key:0,class:"h-3 w-3 mr-1 text-green-400"})):(s(),C(K,{key:1,class:"h-3 w-3 mr-1 text-white"})),a("span",Ue,y(l.patient_name),1)]),_:2},1032,["href"]),a("p",Me,[d(F,{class:"h-3 w-3 mr-1 text-white"}),a("span",Te,y(l.author),1)]),a("p",Fe,[d(F,{class:"h-3 w-3 mr-1 text-white"}),a("span",Ne,y(l.attending),1)])])],64)):g("",!0)],2))),128))])):g("",!0)]),_:2},1024)])),64))])):(s(),r("p",je," \u0E4F No cases "))}},Ee={class:"md:flex items-end md:space-x-4"},Oe=["href"],ze=a("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," Acute dialysis unit ",-1),Ae={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll pb-2 md:pb-4 border-b-2 border-dashed border-complement"},De={class:"font-medium text-complement italic"},Re=a("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," Ward ",-1),Ke={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll pb-2 md:pb-4 border-b-2 border-dashed border-complement"},Le={class:"font-medium text-complement italic"},Pe=a("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement"}," COVID cases ",-1),We={class:"grid grid-flow-col grid-rows-1 gap-4 xl:gap-8 overflow-x-scroll"},Ge={class:"font-medium text-complement italic"},nt={__name:"ScheduleIndex",props:{query:{type:Object,required:!0},slots:{type:Array,required:!0},configs:{type:Object,required:!0}},setup(t){var p,l;const i=t,e=j({ref_date:(p=i.query.ref_date)!=null?p:null,full_week:((l=i.query.full_week)!=null?l:!1)==="on"});return S(()=>e,n=>{let m=J(n);m=Object.keys(m).length?m:{remember:"forget"},m.full_week!==void 0&&(m.full_week="on"),Q.Inertia.get(location.pathname,m,{preserveState:!0,preserveScroll:!0})},{deep:!0}),(n,m)=>(s(),r(k,null,[t.configs.can.create_order?(s(),C(we,{key:0,class:"border-b-2 border-dashed pb-2 mb-2 md:pb-4 md:mb-4",configs:t.configs},null,8,["configs"])):g("",!0),a("div",Ee,[d(A,{label:"reference date",name:"ref_date",modelValue:e.ref_date,"onUpdate:modelValue":m[0]||(m[0]=f=>e.ref_date=f)},null,8,["modelValue"]),a("a",{class:"block mt-4 md:mt-0 w-full btn btn-complement h-10 text-center",href:t.configs.routes.orders_export}," Export excel ",8,Oe)]),d(O,{class:"mt-6 md:mt-12 xl:mt-24",toggler:!0,modelValue:e.full_week,"onUpdate:modelValue":m[1]||(m[1]=f=>e.full_week=f),label:"Full week"},null,8,["modelValue"]),ze,a("div",Ae,[(s(!0),r(k,null,$(t.slots,f=>(s(),r("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:f.date_note},[a("label",De,y(f.date_label),1),d(D,{slots:f.hd_unit},null,8,["slots"])]))),128))]),Re,a("div",Ke,[(s(!0),r(k,null,$(t.slots,f=>(s(),r("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:f.date_note},[a("label",Le,y(f.date_label),1),d(L,{slots:f.ward},null,8,["slots"])]))),128))]),Pe,a("div",We,[(s(!0),r(k,null,$(t.slots,f=>(s(),r("div",{class:"w-[21rem] sm:w-[22-rem] md:w-[24rem]",key:f.date_note},[a("label",Ge,y(f.date_label),1),d(Be,{slots:f.covid_cases},null,8,["slots"])]))),128))])],64))}};export{nt as default};
