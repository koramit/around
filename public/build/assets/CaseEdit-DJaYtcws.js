const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ConfirmFormComposable-DNj8RUXX.js","assets/FormInput-C0sFZaw5.js","assets/app-DPyxr6eT.js","assets/app-BT2oe5WW.css","assets/SpinnerButton-D4TpFu-c.js","assets/ModalDialog-DpsT1Y2c.js","assets/ModalDialog-D8Qet6-I.css"])))=>i.map(i=>d[i]);
import{h as d,c as u,b as s,F as g,l as k,t as f,j as _,g as p,e as c,d as r,H as z,f as U,A as H,k as J,T as N,y as K,v as h,r as Q,o as X,n as Y,m as O,u as l,S as Z,E as ee,L as oe,G as le}from"./app-DPyxr6eT.js";import{u as te}from"./useSelectOther-Cof-HEvD.js";import{u as se}from"./useConfirmForm-CGSQwZw7.js";import{_ as m}from"./FormInput-C0sFZaw5.js";import{_ as V}from"./FormRadio-o7psNeRm.js";import{_ as A}from"./FormCheckbox-BDfOwZVW.js";import{_ as $}from"./FormDatetime-BuCMUHjp.js";import{_ as R}from"./ImageUploader-CC1_XpwP.js";import re from"./FormSelectOther-D8eDjH_9.js";import{I as ae}from"./IconUserMd-6DXYmU3N.js";import{I as ne,_ as de}from"./IconDoubleDown-Dhv7VOMF.js";import{_ as j}from"./ActionColumn-yE4MjzBV.js";import{F as ie,_ as me}from"./FallbackSpinner-C6wHCKi_.js";import{_ as ue}from"./CommentSection-DkWFoR1L.js";import{_ as F}from"./SpinnerButton-D4TpFu-c.js";import"./IconEyesSlash-BKkraADE.js";import"./IconEyes-DAYzhujW.js";import"./IconTrashXMark-C0dg-Rsg.js";import"./ModalDialog-DpsT1Y2c.js";import"./FormTextarea-BRcuvMLl.js";const pe={key:0,class:"space-y-1"},ce={class:"bg-white rounded shadow overflow-x-auto hidden md:block"},_e={class:"w-full whitespace-nowrap pb-48"},fe={class:"text-left font-semibold text-complement"},ge=["textContent","colspan"],be=["textContent"],Ve={class:"border-t"},ye={class:"md:hidden space-y-2"},ve={class:"flex justify-between items-center my-2 px-2"},xe={class:"bg-primary-darker p-2 rounded-full"},he={class:"my-2 p-2 bg-gray-100 rounded space-y-2"},ke={class:"flex items-center justify-between"},Ce={class:"text-xs italic text-complement font-semibold"},$e={class:"font-semibold text-complement text-xs flex items-center"},Ue={class:"block italic truncate"},we={class:"flex items-center justify-between"},Oe=["textContent"],Ae=["textContent"],Se={key:1,class:"italic"},Ee={__name:"OrderIndex",props:{orders:{type:Array,required:!0}},setup(y){const{setActionStore:S,resetActionStore:v}=H(),n=o=>{v(),S(o)};return(o,b)=>y.orders.length?(d(),u("div",pe,[s("div",ce,[s("table",_e,[s("tr",fe,[(d(),u(g,null,k(["On","Type","At","Status","MD"],i=>s("th",{class:"px-6 pt-6 pb-4",key:i,textContent:f(i),colspan:i==="MD"?2:1},null,8,ge)),64))]),(d(!0),u(g,null,k(y.orders,(i,x)=>(d(),u("tr",{class:"focus-within:bg-primary-darker",key:x},[(d(),u(g,null,k(["date_note","dialysis_type","ward_name","status","md"],C=>s("td",{class:"px-6 py-4 border-t",key:C,textContent:f(i[C])},null,8,be)),64)),s("td",Ve,[i.actions.length?(d(),_(j,{key:0,actions:i.actions,onActionClicked:n},null,8,["actions"])):p("",!0)])]))),128))])]),s("div",ye,[(d(!0),u(g,null,k(y.orders,(i,x)=>(d(),u("div",{class:"bg-white rounded shadow my-4 p-4",key:x},[s("div",ve,[s("div",null,f(i.ward_name),1),i.actions.length>1?(d(),_(z,{key:0},{default:c(()=>[s("div",xe,[r(ne,{class:"w-4 h-4 text-accent"})])]),dropdown:c(()=>[r(de,{actions:i.actions,onActionClicked:n},null,8,["actions"])]),_:2},1024)):i.actions.length===1?(d(),_(j,{key:1,actions:i.actions,onActionClicked:n},null,8,["actions"])):p("",!0)]),s("div",he,[s("div",ke,[s("p",Ce,f(i.status),1),s("p",$e,[r(ae,{class:"h-3 w-3 mr-1"}),s("span",Ue,f(i.md),1)])]),s("div",we,[s("p",null,[b[0]||(b[0]=U(" On : ")),s("span",{class:"text-complement font-semibold",textContent:f(i.date_note)},null,8,Oe)]),s("p",null,[b[1]||(b[1]=U(" Type : ")),s("span",{class:"text-complement font-semibold",textContent:f(i.dialysis_type)},null,8,Ae)])])])]))),128))])])):(d(),u("p",Se," No order yet "))}},Ie={class:"grid gap-2 md:grid md:gap-4 md:grid-cols-2 xl:gap-8"},Fe={class:"grid gap-2 md:grid-cols-2 md:gap-4 xl:gap-6"},Te={key:0,class:"grid gap-2 md:grid md:gap-4 md:grid-cols-2 xl:gap-8"},De={class:"form-label mt-4 md:mt-8 xl:mt-16"},Me={class:"md:grid grid-cols-2 gap-2 lg:gap-x-8"},Ne={class:"mt-2 md:mt-4 xl:mt-6 grid gap-2 md:gap-4 xl:gap-6 2xl:grid-cols-2"},Re={id:"indications",class:"form-scroll-mt text-red-400"},je={class:"mt-2 md:mt-4 xl:mt-6 grid gap-2 md:gap-4 xl:gap-6 2xl:grid-cols-2"},He={class:"grid gap-2 md:grid-cols-2 md:gap-4 xl:gap-6"},Le={id:"opd_consent_form",class:"form-error-block form-scroll-mt"},Be={id:"ipd_consent_form",class:"form-error-block form-scroll-mt"},mo={__name:"CaseEdit",props:{caseRecordForm:{type:Object,required:!0},orders:{type:Array,required:!0},formConfigs:{type:Object,required:!0},gotoSection:{type:[String,null],default:null}},setup(y){const S=ee(()=>le(()=>import("./ConfirmFormComposable-DNj8RUXX.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),v=y,n=J({...v.formConfigs}),o=N({...v.caseRecordForm}),b={previous_crrt:!0},{autosave:i}=K();h(()=>o.data(),a=>{!a.previous_crrt&&!b.previous_crrt?(a.date_start_crrt=null,a.date_end_crrt=null,b.previous_crrt=!0):a.previous_crrt&&(b.previous_crrt=!1),i(a,n.routes.update)},{deep:n.can.update}),h(()=>o.indications.initiate_chronic_hd,a=>{a&&(o.indications.maintain_chronic_hd=!1,o.indications.change_from_pd=!1)}),h(()=>o.indications.maintain_chronic_hd,a=>{a&&(o.indications.initiate_chronic_hd=!1,o.indications.change_from_pd=!1)}),h(()=>o.indications.change_from_pd,a=>{a&&(o.indications.initiate_chronic_hd=!1,o.indications.maintain_chronic_hd=!1)});const x=Q(null);o.insurance&&!n.insurances.includes(o.insurance)&&n.insurances.push(o.insurance),h(()=>o.insurance,a=>{a==="other"&&(w.placeholder="Other Insurance",w.configs=n.insurances,w.input=x.value,C.value.open())});const{selectOtherInput:C,selectOther:w,selectOtherClosed:L}=te(),T=()=>o.post(n.routes.case_complete),D=()=>o.put(n.routes.case_addendum),B=()=>o.transform(a=>({...a,force:!0})).post(n.routes.case_complete),P=a=>{N({reason:a}).delete(M.value.route)},{confirmForm:q,openConfirmForm:G,confirmed:W}=se(),{actionStore:M}=H();return h(()=>M.value,a=>{switch(a.name){case"complete-case":T();break;case"addendum-case":D();break;case"cancel-case":case"cancel-order":G(a.config);break}}),X(()=>{v.gotoSection!==null&&Y(()=>{const{smoothScroll:a}=oe();a(v.gotoSection)})}),(a,e)=>(d(),u(g,null,[s("div",null,[r(O,{mode:"out-in"},{default:c(()=>[n.case_status==="active"&&n.covid.hn&&!Object.keys(a.$page.props.errors).length?(d(),_(Z,{key:0},{fallback:c(()=>[r(ie)]),default:c(()=>[r(me,{class:"mb-4",configs:n.covid},null,8,["configs"])]),_:1})):p("",!0)]),_:1})]),e[40]||(e[40]=s("h2",{class:"form-label text-lg italic text-complement scroll-mt-16 md:scroll-mt-8",id:"case-record"}," Case record ",-1)),e[41]||(e[41]=s("hr",{class:"my-4 border-b border-accent"},null,-1)),s("div",Ie,[r(m,{label:"hn",readonly:!0,name:"hn",modelValue:l(o).record.hn,"onUpdate:modelValue":e[0]||(e[0]=t=>l(o).record.hn=t)},null,8,["modelValue"]),r(m,{label:"an",readonly:!0,name:"an",modelValue:l(o).admission.an,"onUpdate:modelValue":e[1]||(e[1]=t=>l(o).admission.an=t),placeholder:"No active admission"},null,8,["modelValue"]),r(m,{label:"first md",readonly:!0,name:"first_md",modelValue:l(o).computed.first_md,"onUpdate:modelValue":e[2]||(e[2]=t=>l(o).computed.first_md=t)},null,8,["modelValue"]),r(m,{label:"first dialysis on",readonly:!0,name:"first_dialysis_at",modelValue:l(o).computed.first_dialysis_at,"onUpdate:modelValue":e[3]||(e[3]=t=>l(o).computed.first_dialysis_at=t)},null,8,["modelValue"]),r(m,{label:"latest md",readonly:!0,name:"latest_md",modelValue:l(o).computed.latest_md,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).computed.latest_md=t)},null,8,["modelValue"]),r(m,{label:"latest dialysis on",readonly:!0,name:"latest_dialysis_at",modelValue:l(o).computed.latest_dialysis_at,"onUpdate:modelValue":e[5]||(e[5]=t=>l(o).computed.latest_dialysis_at=t)},null,8,["modelValue"]),l(o).admission.an?(d(),u(g,{key:0},[r(m,{label:"admitted on",readonly:!0,name:"admitted_at",modelValue:l(o).admission.admitted_at,"onUpdate:modelValue":e[6]||(e[6]=t=>l(o).admission.admitted_at=t)},null,8,["modelValue"]),r(m,{label:"discharged on",readonly:!0,name:"discharged_at",modelValue:l(o).admission.discharged_at,"onUpdate:modelValue":e[7]||(e[7]=t=>l(o).admission.discharged_at=t)},null,8,["modelValue"]),r(m,{label:"ward admit",readonly:!0,name:"ward_admit",modelValue:l(o).admission.ward_admit,"onUpdate:modelValue":e[8]||(e[8]=t=>l(o).admission.ward_admit=t)},null,8,["modelValue"]),r(m,{label:"ward discharge",readonly:!0,name:"ward_discharge",modelValue:l(o).admission.ward_discharge,"onUpdate:modelValue":e[9]||(e[9]=t=>l(o).admission.ward_discharge=t)},null,8,["modelValue"])],64)):p("",!0)]),e[42]||(e[42]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),e[43]||(e[43]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Outcome : ",-1)),s("div",Fe,[s("div",null,[r(V,{label:"renal outcome",name:"renal_outcome",modelValue:l(o).renal_outcome,"onUpdate:modelValue":e[10]||(e[10]=t=>l(o).renal_outcome=t),"allow-reset":!0,options:n.renal_outcomes,error:a.$page.props.errors.renal_outcome},null,8,["modelValue","options","error"]),r(O,{name:"slide-fade"},{default:c(()=>[l(o).renal_outcome==="Recovery"?(d(),_(m,{key:0,label:"last creatinine",class:"mt-2 md:mt-t xl:mt-6",name:"cr_before_discharge",modelValue:l(o).cr_before_discharge,"onUpdate:modelValue":e[11]||(e[11]=t=>l(o).cr_before_discharge=t),error:a.$page.props.errors.cr_before_discharge},null,8,["modelValue","error"])):p("",!0)]),_:1})]),s("div",null,[r(V,{label:"patient outcome",name:"patient_outcome",modelValue:l(o).patient_outcome,"onUpdate:modelValue":e[12]||(e[12]=t=>l(o).patient_outcome=t),"allow-reset":!0,options:n.patient_outcomes,error:a.$page.props.errors.patient_outcome},null,8,["modelValue","options","error"]),r(O,{name:"slide-fade"},{default:c(()=>[l(o).patient_outcome==="Dead"?(d(),_(m,{key:0,label:"cause of dead",class:"mt-2 md:mt-t xl:mt-6",name:"cause_of_dead",modelValue:l(o).cause_of_dead,"onUpdate:modelValue":e[13]||(e[13]=t=>l(o).cause_of_dead=t),error:a.$page.props.errors.cause_of_dead},null,8,["modelValue","error"])):p("",!0)]),_:1})])]),e[44]||(e[44]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),r(A,{class:"mt-4 md:mb-4 md:mt-8 xl:mt-16",label:"Previous CRRT",modelValue:l(o).previous_crrt,"onUpdate:modelValue":e[14]||(e[14]=t=>l(o).previous_crrt=t),toggler:!0},null,8,["modelValue"]),r(O,{name:"slide-fade"},{default:c(()=>[l(o).previous_crrt?(d(),u("div",Te,[r($,{label:"date start crrt",name:"date_start_crrt",modelValue:l(o).date_start_crrt,"onUpdate:modelValue":e[15]||(e[15]=t=>l(o).date_start_crrt=t),error:a.$page.props.errors.date_start_crrt},null,8,["modelValue","error"]),r($,{label:"date end crrt",name:"date_end_crrt",modelValue:l(o).date_end_crrt,"onUpdate:modelValue":e[16]||(e[16]=t=>l(o).date_end_crrt=t),error:a.$page.props.errors.date_end_crrt},null,8,["modelValue","error"])])):p("",!0)]),_:1}),e[45]||(e[45]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),e[46]||(e[46]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Renal diagnosis : ",-1)),r(V,{class:"sm:grid grid-cols-2 gap-x-2 lg:grid-cols-4",name:"renal_diagnosis",modelValue:l(o).renal_diagnosis,"onUpdate:modelValue":e[17]||(e[17]=t=>l(o).renal_diagnosis=t),options:[...n.renal_diagnosis],error:a.$page.props.errors.renal_diagnosis},null,8,["modelValue","options","error"]),e[47]||(e[47]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),s("h3",De,f(l(o).admission.an?"admission":"")+" diagnosis : ",1),r(m,{name:"admission_diagnosis",modelValue:l(o).admission_diagnosis,"onUpdate:modelValue":e[18]||(e[18]=t=>l(o).admission_diagnosis=t),error:a.$page.props.errors.admission_diagnosis},null,8,["modelValue","error"]),e[48]||(e[48]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),s("div",Me,[s("div",null,[e[32]||(e[32]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Comorbidities : ",-1)),s("div",Ne,[(d(!0),u(g,null,k(n.comorbidities,(t,E)=>(d(),_(A,{key:E,name:t.name,label:t.label,modelValue:l(o).comorbidities[t.name],"onUpdate:modelValue":I=>l(o).comorbidities[t.name]=I},null,8,["name","label","modelValue","onUpdate:modelValue"]))),128))]),r(m,{class:"mt-2 md:mt-4 xl:mt-6 h-auto",name:"comorbidities_other",label:"Other comorbidities",modelValue:l(o).comorbidities.other,"onUpdate:modelValue":e[19]||(e[19]=t=>l(o).comorbidities.other=t),error:a.$page.props.errors["comorbidities.other"]},null,8,["modelValue","error"])]),s("div",null,[e[33]||(e[33]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Indication for dialysis : ",-1)),s("small",Re,f(a.$page.props.errors.indications),1),s("div",je,[(d(!0),u(g,null,k(n.indications,(t,E)=>(d(),_(A,{key:E,name:t.name,label:t.label,modelValue:l(o).indications[t.name],"onUpdate:modelValue":I=>l(o).indications[t.name]=I},null,8,["name","label","modelValue","onUpdate:modelValue"]))),128))]),r(m,{class:"mt-2 md:mt-4 xl:mt-6 h-auto",name:"indications.other",label:"Other indications",modelValue:l(o).indications.other,"onUpdate:modelValue":e[20]||(e[20]=t=>l(o).indications.other=t),error:a.$page.props.errors["indications.other"]},null,8,["modelValue","error"])])]),e[49]||(e[49]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),e[50]||(e[50]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Serology : ",-1)),s("div",He,[s("div",null,[e[34]||(e[34]=s("label",{class:"form-label"},"HBs Ag",-1)),r(V,{class:"grid lg:grid-cols-2 gap-x-2",name:"hbs_ag",modelValue:l(o).hbs_ag,"onUpdate:modelValue":e[21]||(e[21]=t=>l(o).hbs_ag=t),options:n.serology_results,error:a.$page.props.errors.hbs_ag},null,8,["modelValue","options","error"])]),r($,{label:"date HBs Ag",name:"date_hbs_ag",modelValue:l(o).date_hbs_ag,"onUpdate:modelValue":e[22]||(e[22]=t=>l(o).date_hbs_ag=t)},null,8,["modelValue"]),s("div",null,[e[35]||(e[35]=s("label",{class:"form-label"},"anti hcv",-1)),r(V,{class:"grid lg:grid-cols-2 gap-x-2",name:"anti_hcv",modelValue:l(o).anti_hcv,"onUpdate:modelValue":e[23]||(e[23]=t=>l(o).anti_hcv=t),options:n.serology_results,error:a.$page.props.errors.anti_hcv},null,8,["modelValue","options","error"])]),r($,{label:"date anti hcv",name:"date_anti_hcv",modelValue:l(o).date_anti_hcv,"onUpdate:modelValue":e[24]||(e[24]=t=>l(o).date_anti_hcv=t)},null,8,["modelValue"]),s("div",null,[e[36]||(e[36]=s("label",{class:"form-label"},"anti HIV",-1)),r(V,{class:"grid lg:grid-cols-2 gap-x-2",name:"anti_hiv",modelValue:l(o).anti_hiv,"onUpdate:modelValue":e[25]||(e[25]=t=>l(o).anti_hiv=t),options:n.serology_results,error:a.$page.props.errors.anti_hiv},null,8,["modelValue","options","error"])]),r($,{label:"date anti HIV",name:"date_anti_hiv",modelValue:l(o).date_anti_hiv,"onUpdate:modelValue":e[26]||(e[26]=t=>l(o).date_anti_hiv=t)},null,8,["modelValue"])]),e[51]||(e[51]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),e[52]||(e[52]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Consent : ",-1)),r(R,{label:"๏ opd consent form",pathname:n.opd_consent_form_pathname,modelValue:l(o).opd_consent_form,"onUpdate:modelValue":e[27]||(e[27]=t=>l(o).opd_consent_form=t),"service-endpoints":n.image_upload_endpoints},null,8,["pathname","modelValue","service-endpoints"]),s("small",Le,f(a.$page.props.errors.opd_consent_form),1),l(o).admission.an?(d(),u(g,{key:0},[r(R,{class:"mt-4 md:mt-6",label:"๏ ipd consent form",pathname:n.ipd_consent_form_pathname,"service-endpoints":n.image_upload_endpoints,modelValue:l(o).ipd_consent_form,"onUpdate:modelValue":e[28]||(e[28]=t=>l(o).ipd_consent_form=t)},null,8,["pathname","service-endpoints","modelValue"]),s("small",Be,f(a.$page.props.errors.ipd_consent_form),1),r(A,{class:"mt-4 md:mt-6",label:"Use same form",name:"same_consent_form",modelValue:l(o).same_consent_form,"onUpdate:modelValue":e[29]||(e[29]=t=>l(o).same_consent_form=t),toggler:!0},null,8,["modelValue"])],64)):p("",!0),e[53]||(e[53]=s("hr",{class:"border border-dashed my-2 md:my-4 xl:my-8"},null,-1)),e[54]||(e[54]=s("h3",{class:"form-label mt-4 md:mt-8 xl:mt-16"}," Medical scheme : ",-1)),r(V,{name:"insurance",class:"md:grid grid-cols-2 gap-2",modelValue:l(o).insurance,"onUpdate:modelValue":e[30]||(e[30]=t=>l(o).insurance=t),options:n.insurances,"allow-other":!0,ref_key:"insurance",ref:x,error:a.$page.props.errors.insurance},null,8,["modelValue","options","error"]),n.can.complete?(d(),_(F,{key:1,onClick:T,spin:l(o).processing,class:"mt-4 md:mt-8 w-full btn-accent"},{default:c(()=>e[37]||(e[37]=[U(" COMPLETE CASE ")])),_:1},8,["spin"])):p("",!0),n.can.force_complete?(d(),_(F,{key:2,onClick:B,spin:l(o).processing,class:"mt-4 md:mt-8 w-full btn-complement"},{default:c(()=>e[38]||(e[38]=[U(" COMPLETE CASE WITHOUT CONSENT FORM ")])),_:1},8,["spin"])):p("",!0),n.can.addendum?(d(),_(F,{key:3,onClick:D,spin:l(o).processing,class:"mt-4 md:mt-8 w-full btn-complement"},{default:c(()=>e[39]||(e[39]=[U(" ADDENDUM CASE ")])),_:1},8,["spin"])):p("",!0),e[55]||(e[55]=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement",id:"orders"}," Orders ",-1)),e[56]||(e[56]=s("hr",{class:"my-4 border-b border-accent"},null,-1)),r(Ee,{orders:y.orders},null,8,["orders"]),e[57]||(e[57]=s("h2",{class:"mt-6 md:mt-12 xl:mt-24 form-label italic text-xl text-complement scroll-mt-16 md:scroll-mt-8",id:"discussion"}," discussion ",-1)),e[58]||(e[58]=s("hr",{class:"my-4 border-b border-accent"},null,-1)),r(ue,{configs:n.comment},null,8,["configs"]),r(re,{placeholder:l(w).placeholder,ref_key:"selectOtherInput",ref:C,onClosed:l(L)},null,8,["placeholder","onClosed"]),r(l(S),{ref_key:"confirmForm",ref:q,onConfirmed:e[31]||(e[31]=t=>l(W)(t,P))},null,512)],64))}};export{mo as default};
