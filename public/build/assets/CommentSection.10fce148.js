import{_ as V,o as n,c as r,a as i,q as g,t as C,i as x,k as S,s as k,r as f,E as U,M as h,Q as q,b as d,w as y,T as R,H as A,R as E,F as T,v as M,d as I,n as O,U as j,G as D}from"./app.005d5d1d.js";import{_ as L}from"./FormTextarea.46b77843.js";import{_ as z}from"./SpinnerButton.a7707d1a.js";import{_ as B}from"./FormCheckbox.f65c4387.js";const F={},G={viewBox:"0 0 640 512"},Y=i("path",{fill:"currentColor",d:"M634 471L36 3.51A16 16 0 0 0 13.51 6l-10 12.49A16 16 0 0 0 6 41l598 467.49a16 16 0 0 0 22.49-2.49l10-12.49A16 16 0 0 0 634 471zM296.79 146.47l134.79 105.38C429.36 191.91 380.48 144 320 144a112.26 112.26 0 0 0-23.21 2.47zm46.42 219.07L208.42 260.16C210.65 320.09 259.53 368 320 368a113 113 0 0 0 23.21-2.46zM320 112c98.65 0 189.09 55 237.93 144a285.53 285.53 0 0 1-44 60.2l37.74 29.5a333.7 333.7 0 0 0 52.9-75.11 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64c-36.7 0-71.71 7-104.63 18.81l46.41 36.29c18.94-4.3 38.34-7.1 58.22-7.1zm0 288c-98.65 0-189.08-55-237.93-144a285.47 285.47 0 0 1 44.05-60.19l-37.74-29.5a333.6 333.6 0 0 0-52.89 75.1 32.35 32.35 0 0 0 0 29.19C89.72 376.41 197.08 448 320 448c36.7 0 71.71-7.05 104.63-18.81l-46.41-36.28C359.28 397.2 339.89 400 320 400z"},null,-1),Q=[Y];function J(s,t){return n(),r("svg",G,Q)}var K=V(F,[["render",J]]);const W={},X={viewBox:"0 0 576 512"},Z=i("path",{fill:"currentColor",d:"M288 144a110.94 110.94 0 0 0-31.24 5 55.4 55.4 0 0 1 7.24 27 56 56 0 0 1-56 56 55.4 55.4 0 0 1-27-7.24A111.71 111.71 0 1 0 288 144zm284.52 97.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400c-98.65 0-189.09-55-237.93-144C98.91 167 189.34 112 288 112s189.09 55 237.93 144C477.1 345 386.66 400 288 400z"},null,-1),ee=[Z];function te(s,t){return n(),r("svg",X,ee)}var ne=V(W,[["render",te]]);const oe={},le={viewBox:"0 0 512 512"},se=i("path",{fill:"currentColor",d:"M8.31 189.9l176-151.1c15.41-13.3 39.69-2.509 39.69 18.16v80.05C384.6 137.9 512 170.1 512 322.3c0 61.44-39.59 122.3-83.34 154.1c-13.66 9.938-33.09-2.531-28.06-18.62c45.34-145-21.5-183.5-176.6-185.8v87.92c0 20.7-24.31 31.45-39.69 18.16l-176-151.1C-2.753 216.6-2.784 199.4 8.31 189.9z"},null,-1),ae=[se];function ie(s,t){return n(),r("svg",le,ae)}var ce=V(oe,[["render",ie]]);const re={},me={viewBox:"0 0 512 512"},de=i("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm101.8-262.2L295.6 256l62.2 62.2c4.7 4.7 4.7 12.3 0 17l-22.6 22.6c-4.7 4.7-12.3 4.7-17 0L256 295.6l-62.2 62.2c-4.7 4.7-12.3 4.7-17 0l-22.6-22.6c-4.7-4.7-4.7-12.3 0-17l62.2-62.2-62.2-62.2c-4.7-4.7-4.7-12.3 0-17l22.6-22.6c4.7-4.7 12.3-4.7 17 0l62.2 62.2 62.2-62.2c4.7-4.7 12.3-4.7 17 0l22.6 22.6c4.7 4.7 4.7 12.3 0 17z"},null,-1),ue=[de];function pe(s,t){return n(),r("svg",me,ue)}var P=V(re,[["render",pe]]);const _e=["innerHTML"],fe={class:"mt-4 md:mt-8 flex justify-between text-xs"},ye=i("span",null,"reply",-1),ve={class:"italic text-complement"},be={class:"ml-1 text-accent"},H={__name:"CommentBody",props:{comment:{type:Object,required:!0},showReplies:{type:Boolean},replying:{type:Boolean}},emits:["reply","show-replies"],setup(s){return(t,m)=>(n(),r("div",{class:S(["p-2 pb-1 md:p-4 md:pb-2 bg-primary-darker text-complement rounded",{"rounded-b rounded-t-none":s.comment.parent_body!==void 0&&s.comment.parent_body}])},[i("p",{innerHTML:s.comment.body},null,8,_e),i("div",fe,[i("div",null,[i("button",{class:"inline-flex items-center text-accent space-x-1 md:space-x-2",onClick:m[0]||(m[0]=e=>t.$emit("reply"))},[s.replying?(n(),g(P,{key:0,class:"w-3 h-3"})):(n(),g(ce,{key:1,class:"w-3 h-3"})),ye]),s.comment.replies_count?(n(),r("button",{key:0,class:"inline-flex items-center text-accent ml-2 md:ml-4 space-x-1 md:space-x-2",onClick:m[1]||(m[1]=e=>t.$emit("show-replies"))},[s.showReplies?(n(),g(K,{key:0,class:"h-3 w-3"})):(n(),g(ne,{key:1,class:"h-3 w-3"})),i("span",null,C(s.comment.replies_count)+" "+C(s.comment.replies_count>1?"replies":"reply"),1)])):x("",!0)]),i("div",null,[i("span",ve,C(s.comment.at)+" by",1),i("span",be,C(s.comment.commentator),1)])])],2))}},ge={class:"mt-2 md:mt-4"},he={key:0,class:"ml-4 mt-4"},$e=I(" REPLY "),xe={class:"border-accent border-l"},we={__name:"CommentRecursive",props:{propComment:{type:Object,required:!0}},setup(s){const m=k({...s.propComment}),e=f(null),o=f(!1),$=()=>{o.value=!o.value,o.value&&O(()=>{setTimeout(()=>{h().props.value.event.payload=m.id,h().props.value.event.name="comment-recursive-reply-active",h().props.value.event.fire=+new Date},300),e.value.focus()})};U(()=>h().props.value.event.fire,p=>{!p||h().props.value.event.name==="comment-recursive-reply-active"&&o.value&&m.id!==h().props.value.event.payload&&(o.value=!1)});const l=k({body:null,notify_op:!1}),v=()=>{window.axios.post(m.routes.reply,l).then(p=>{l.body=null,l.notify_op=!1,_.value=[...p.data],m.replies_count=_.value.length,O(()=>{o.value=!1,u.value||(u.value=!0)})}).catch(p=>console.log(p))},u=f(!1),_=f([]),w=()=>{if(u.value){u.value=!1;return}if(_.value.length){u.value=!0;return}window.axios.get(m.routes.show).then(p=>{_.value=[...p.data],u.value=!0}).catch(p=>console.log(p))};return(p,c)=>{const b=q("CommentRecursive",!0);return n(),r("li",ge,[d(H,{comment:m,"show-replies":u.value,replying:o.value,onShowReplies:w,onReply:$},null,8,["comment","show-replies","replying"]),d(R,{name:"slide-fade"},{default:y(()=>[o.value?(n(),r("div",he,[d(L,{name:"body",modelValue:l.body,"onUpdate:modelValue":c[0]||(c[0]=a=>l.body=a),ref_key:"replyInput",ref:e},null,8,["modelValue"]),d(B,{toggler:!0,label:"Notify OP",modelValue:l.notify_op,"onUpdate:modelValue":c[1]||(c[1]=a=>l.notify_op=a),class:"my-2 md:mt-4"},null,8,["modelValue"]),d(z,{spin:l.processing,class:"btn btn-complement mt-4 w-full",onClick:v,disabled:!l.body},{default:y(()=>[$e]),_:1},8,["spin","disabled"])])):x("",!0)]),_:1}),d(R,{name:"slide-fade"},{default:y(()=>[A(i("ul",xe,[(n(!0),r(T,null,M(_.value,a=>(n(),g(b,{key:a.id,"prop-comment":a,class:"ml-4",onShowReplies:w},null,8,["prop-comment"]))),128))],512),[[E,_.value.length&&u.value]])]),_:1})])}}},Ce={class:"mb-4 md:mb-8"},ke=I(" POST "),Ve={__name:"CommentReplyOriented",props:{configs:{type:Object,required:!0}},setup(s){const t=s,m=f(null),e=f([]);window.axios.get(t.configs.routes.reply_index,{params:{commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id}}).then(l=>e.value=l.data).catch(l=>console.log(l));const o=k({commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id,body:null,notify_op:!1,processing:!1}),$=()=>{o.processing=!0,window.axios.post(t.configs.routes.reply_store,o).then(l=>{e.value.push(l.data),o.body=null,o.notify_op=!1}).catch(l=>console.log(l)).finally(()=>o.processing=!1)};return(l,v)=>(n(),r("div",null,[i("ul",Ce,[d(j,{name:"flip-list"},{default:y(()=>[(n(!0),r(T,null,M(e.value,u=>(n(),g(we,{key:u.id,"prop-comment":u},null,8,["prop-comment"]))),128))]),_:1})]),d(L,{name:"body",modelValue:o.body,"onUpdate:modelValue":v[0]||(v[0]=u=>o.body=u),ref_key:"commentInput",ref:m},null,8,["modelValue"]),d(B,{toggler:!0,label:"Notify OP",modelValue:o.notify_op,"onUpdate:modelValue":v[1]||(v[1]=u=>o.notify_op=u),class:"my-2 md:mt-4"},null,8,["modelValue"]),d(z,{spin:o.processing,class:"btn btn-accent mt-4 w-full",onClick:$,disabled:!o.body},{default:y(()=>[ke]),_:1},8,["spin","disabled"])]))}},Re={class:"mb-4 md:mb-8"},Te=["id"],Me=["onClick"],Ie=["innerHTML"],Le={key:0,class:"flex justify-between items-start space-x-2 md:space-x-4 p-2 md:p-4 rounded-t-lg bg-complement/50 text-white"},ze=["innerHTML"],Be={__name:"CommentTimelineOriented",props:{configs:{type:Object,required:!0}},setup(s){const t=s,m=f([]);window.axios.get(t.configs.routes.timeline_index,{params:{commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id}}).then(c=>m.value=c.data).catch(c=>console.log(c));const e=k({commentable_type:t.configs.commentable_type,commentable_id:t.configs.commentable_id,body:null,notify_op:!1,parent_id:null,processing:!1}),o=f(null),$=()=>{e.processing=!0,window.axios.post(t.configs.routes.timeline_store,e).then(c=>{m.value.push(c.data),e.body=null,e.notify_op=!1,e.parent_id=null,l.body=null}).catch(c=>console.log(c)).finally(()=>e.processing=!1)},l=k({body:null}),v=c=>{if(e.parent_id===c.id){l.body=null,e.parent_id=null,e.body=null;return}l.body=c.body,e.parent_id=c.id,p("#comment_body"),setTimeout(()=>o.value.focus(),300)},u=()=>{l.body=null,e.parent_id=null},_=f(null),w=c=>{_.value=c,p(`#comment-id-${c}`),setTimeout(()=>_.value=null,2e3)},{smoothScroll:p}=D();return(c,b)=>(n(),r("div",null,[i("ul",Re,[d(j,{name:"flip-list"},{default:y(()=>[(n(!0),r(T,null,M(m.value,a=>(n(),r("li",{class:S(["mt-2 md:mt-4 scroll-mt-28 md:scroll-mt-14",{"animate-bounce":_.value===a.id}]),key:a.id,id:`comment-id-${a.id}`},[a.parent_body?(n(),r("div",{key:0,class:"cursor-pointer",onClick:N=>w(a.parent_id)},[i("p",{class:"px-4 py-1 md:px-8 md:py-2 text-xs md:text-sm bg-complement/50 text-white rounded-t italic",innerHTML:a.parent_body},null,8,Ie)],8,Me)):x("",!0),d(H,{onReply:N=>v(a),replying:a.id===e.parent_id,comment:a},null,8,["onReply","replying","comment"])],10,Te))),128))]),_:1})]),d(R,{name:"slide-fade"},{default:y(()=>[l.body?(n(),r("div",Le,[i("p",{innerHTML:l.body,class:"cursor-pointer",onClick:b[0]||(b[0]=a=>w(e.parent_id))},null,8,ze),i("button",{onClick:u},[d(P,{class:"w-4 h-4"})])])):x("",!0)]),_:1}),d(L,{name:"comment_body",modelValue:e.body,"onUpdate:modelValue":b[1]||(b[1]=a=>e.body=a),ref_key:"commentInput",ref:o},null,8,["modelValue"]),d(B,{toggler:!0,label:"Notify OP",modelValue:e.notify_op,"onUpdate:modelValue":b[2]||(b[2]=a=>e.notify_op=a),class:"my-2 md:mt-4"},null,8,["modelValue"]),d(z,{spin:e.processing,class:"btn btn-accent mt-4 w-full",onClick:$,disabled:!e.body},{default:y(()=>[I(C(e.parent_id?"REPLY":"POST"),1)]),_:1},8,["spin","disabled"])]))}},Oe={name:"IconAdjustments"},Se={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},je=i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"},null,-1),Pe=[je];function He(s,t,m,e,o,$){return n(),r("svg",Se,Pe)}var Ne=V(Oe,[["render",He]]);const Ue={class:"text-xs md:text-sm text-accent"},Fe={__name:"CommentSection",props:{configs:{type:Object,required:!0}},setup(s){const t=f(h().props.value.user.preferences.discussion_mode);return(m,e)=>(n(),r("div",null,[i("div",Ue,[d(Ne,{class:"mr-1 w-3 h-4 inline"}),t.value==="reply"?(n(),r("button",{key:0,onClick:e[0]||(e[0]=o=>t.value="timeline")}," Timeline oriented ")):t.value==="timeline"?(n(),r("button",{key:1,onClick:e[1]||(e[1]=o=>t.value="reply")}," Reply oriented ")):x("",!0)]),d(R,{name:"slide-fade",mode:"in-out"},{default:y(()=>[t.value==="reply"?(n(),g(Ve,{key:0,configs:s.configs},null,8,["configs"])):t.value==="timeline"?(n(),g(Be,{key:1,configs:s.configs},null,8,["configs"])):x("",!0)]),_:1})]))}};export{K as I,Fe as _,ne as a};
